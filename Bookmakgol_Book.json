{
  "updatedAt": "2025-11-11T05:56:32.000Z",
  "createdAt": "2025-11-03T08:26:19.720Z",
  "id": "dDiWSm8cQZaADkIs",
  "name": "Bookmakgol_Book",
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "multipleMethods": true,
        "path": "bookmakgol-reservation",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "https://dylankwak57.github.io"
        }
      },
      "id": "59ec3475-ab99-4710-bbdf-3d2ab3f3cfc0",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [
        -608,
        112
      ],
      "webhookId": "bookmakgol-reservation"
    },
    {
      "parameters": {
        "functionCode": "// Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù Î∞è Î≥ÄÌôò\nconst data = items[0].json.body || items[0].json;\n\nconsole.log('Received data:', data);\n\n// ÌïÑÏàò Ìï≠Î™© Ï≤¥ÌÅ¨ (Ïã§Ï†ú Î∞õÏùÄ ÌïÑÎìúÎ™Ö Í∏∞Ï§Ä)\nconst requiredFields = ['branch', 'date', 'time', 'spaceType', 'guests', 'name', 'phone', 'email', 'language'];\nconst missingFields = [];\n\nfor (const field of requiredFields) {\n  if (!data[field] || data[field].toString().trim() === '') {\n    missingFields.push(field);\n  }\n}\n\nconsole.log('Missing fields:', missingFields);\n\nif (missingFields.length > 0) {\n  return [{\n    json: {\n      error: true,\n      message: `Missing required fields: ${missingFields.join(', ')}`,\n      receivedData: data\n    }\n  }];\n}\n\n// Ïù¥Î©îÏùº ÌòïÏãù Í≤ÄÏ¶ù\nconst emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\nif (!emailRegex.test(data.email)) {\n  return [{\n    json: {\n      error: true,\n      message: 'Invalid email format'\n    }\n  }];\n}\n\n// ÎÇ†Ïßú/ÏãúÍ∞Ñ ÌòïÏãù Î≥ÄÌôò\nconst dateTime = `${data.date}T${data.time}:00.000+07:00`; // Bangkok timezone\n\n// ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±Ïö© ÎÇ†Ïßú (YYYYMMDD)\nconst bookingDate = data.date.replace(/-/g, '');\n\n// Í≥µÍ∞Ñ Ï†ïÎ≥¥ ÏÑ§Ï†ï\nlet roomNumber = null;\nlet floor = null;\n\nif (data.spaceType === 'Room') {\n  roomNumber = data.spaceDetail;\n} else {\n  floor = data.spaceDetail;\n}\n\nreturn [{\n  json: {\n    ...data,\n    dateTime: dateTime,\n    bookingDate: bookingDate,\n    roomNumber: roomNumber,\n    floor: floor,\n    status: 'Pending',\n    reminderSent: false,\n    error: false\n  }\n}];"
      },
      "id": "4db679c1-3544-4174-827d-9115a440b9d3",
      "name": "Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        -400,
        112
      ]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{$json.error}}",
              "value2": true
            }
          ]
        }
      },
      "id": "a1295719-22ce-4283-980c-8f077287978d",
      "name": "Í≤ÄÏ¶ù Ïò§Î•ò Ï≤¥ÌÅ¨",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        -192,
        112
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"status\": \"error\",\n  \"message\": \"{{$json.message}}\"\n}",
        "options": {}
      },
      "id": "a89ef268-ae39-4752-90f5-2c24962f8600",
      "name": "Ïò§Î•ò ÏùëÎãµ",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        0,
        0
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "284a2fb1-c15d-81a1-9d93-d4f47300f2e3",
          "mode": "list",
          "cachedResultName": "Bookmakgol Reservation Management",
          "cachedResultUrl": "https://www.notion.so/284a2fb1c15d81a19d93d4f47300f2e3"
        },
        "limit": 100,
        "filterType": "manual",
        "matchType": "allFilters",
        "filters": {
          "conditions": [
            {
              "key": "Reservation DateTime|date",
              "condition": "equals",
              "date": "={{$json.dateTime}}"
            },
            {
              "key": "Branch|select",
              "condition": "equals",
              "selectValue": "={{$json.branch}}"
            },
            {
              "key": "Space Type|select",
              "condition": "equals",
              "selectValue": "={{$json.spaceType}}"
            },
            {
              "key": "Status|select",
              "condition": "does_not_equal",
              "selectValue": "=Cancelled"
            }
          ]
        },
        "options": {}
      },
      "id": "fec3503e-b957-4d10-89d9-ff46db2491f5",
      "name": "Ï§ëÎ≥µ ÏòàÏïΩ Ï≤¥ÌÅ¨",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2,
      "position": [
        0,
        208
      ],
      "alwaysOutputData": true,
      "credentials": {
        "notionApi": {
          "id": "AU29qZb94H2pm2jL",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "functionCode": "// ÏõêÎ≥∏ Îç∞Ïù¥ÌÑ∞Îäî workflowÏùò Îã§Î•∏ ÎÖ∏ÎìúÏóêÏÑú Í∞ÄÏ†∏Ïò§Í∏∞\nconst inputData = $('Í≤ÄÏ¶ù Ïò§Î•ò Ï≤¥ÌÅ¨').item.json;\nconst existingReservations = items.map(item => item.json);\n\nconsole.log('=== INPUT DATA (from Í≤ÄÏ¶ù Ïò§Î•ò Ï≤¥ÌÅ¨) ===');\nconsole.log(JSON.stringify(inputData, null, 2));\n\nconsole.log('=== EXISTING RESERVATIONS (from Notion) ===');\nconsole.log(JSON.stringify(existingReservations, null, 2));\n\nif (inputData.spaceType !== 'Room') {\n  return [{\n    json: {\n      ...inputData,\n      duplicateFound: false\n    }\n  }];\n}\n\n// Î£∏ ÏòàÏïΩ Ï§ëÎ≥µ Ï≤¥ÌÅ¨\nconst duplicates = existingReservations.filter(reservation => {\n  return reservation.properties?.['Room Number']?.select?.name === inputData.roomNumber;\n});\n\nif (duplicates.length > 0) {\n  return [{\n    json: {\n      ...inputData,\n      duplicateFound: true,\n      duplicateMessage: `${inputData.branch} ${inputData.roomNumber}ÏùÄ(Îäî) ${inputData.date} ${inputData.time}Ïóê Ïù¥ÎØ∏ ÏòàÏïΩÎêòÏñ¥ ÏûàÏäµÎãàÎã§.`\n    }\n  }];\n}\n\nreturn [{\n  json: {\n    ...inputData,\n    duplicateFound: false\n  }\n}];"
      },
      "id": "c04a2313-0de1-4f44-a66d-f9d27f5e4498",
      "name": "Ï§ëÎ≥µ Í≤ÄÏÇ¨ Î°úÏßÅ",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        208,
        208
      ]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{$json.duplicateFound}}",
              "value2": true
            }
          ]
        }
      },
      "id": "cdb95e40-2d23-4c3e-850a-a70c0ecf54b5",
      "name": "Ï§ëÎ≥µ ÏòàÏïΩ ÌôïÏù∏",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        400,
        208
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"status\": \"error\",\n  \"message\": \"{{$json.duplicateMessage}}\"\n}",
        "options": {}
      },
      "id": "fc7bf055-bc60-4062-804f-fd7d323bf852",
      "name": "Ï§ëÎ≥µ Ïò§Î•ò ÏùëÎãµ",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        608,
        112
      ]
    },
    {
      "parameters": {
        "functionCode": "// ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ± (ÏïàÏ†ÑÌïú Î≤ÑÏ†Ñ)\nconst data = items[0].json;\n\n// ÏïàÏ†ÑÌïú ÎÇ†Ïßú Ï≤òÎ¶¨\nlet dateForBooking = '';\nif (data.date) {\n  dateForBooking = data.date.replace(/-/g, '');\n} else if (data.bookingDate) {\n  dateForBooking = data.bookingDate;\n} else {\n  // Í∏∞Î≥∏Í∞í ÏÇ¨Ïö©\n  const today = new Date();\n  dateForBooking = today.getFullYear() + \n    String(today.getMonth() + 1).padStart(2, '0') + \n    String(today.getDate()).padStart(2, '0');\n}\n\n// ÏãúÌÄÄÏä§ Î≤àÌò∏ ÏÉùÏÑ±\nconst sequence = String(Date.now()).slice(-3);\n\n// ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±\nconst bookingNumber = `BOOK-${dateForBooking}-${sequence}`;\n\nconsole.log('Generated booking number:', bookingNumber);\n\nreturn [{\n  json: {\n    ...data,\n    bookingNumber: bookingNumber\n  }\n}];"
      },
      "id": "270a54dd-ba8c-4960-90e4-8c8b505ce5bb",
      "name": "ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        608,
        304
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "284a2fb1-c15d-81a1-9d93-d4f47300f2e3",
          "mode": "list",
          "cachedResultName": "Bookmakgol Reservation Management",
          "cachedResultUrl": "https://www.notion.so/284a2fb1c15d81a19d93d4f47300f2e3"
        },
        "title": "={{$json.bookingNumber}}",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Reservation DateTime|date",
              "date": "={{$json.dateTime}}",
              "timezone": "Asia/Bangkok"
            },
            {
              "key": "Branch|select",
              "selectValue": "={{$json.branch}}"
            },
            {
              "key": "Space Type|select",
              "selectValue": "={{$json.spaceType}}"
            },
            {
              "key": "Room Number|select",
              "selectValue": "={{$json.roomNumber}}"
            },
            {
              "key": "Guests|number",
              "numberValue": "={{$json.guests}}"
            },
            {
              "key": "Phone|phone_number",
              "phoneValue": "={{$json.phone}}"
            },
            {
              "key": "Email|email",
              "emailValue": "={{$json.email}}"
            },
            {
              "key": "Language|select",
              "selectValue": "={{$json.language === 'ko' ? 'Korean' : $json.language === 'th' ? 'Thai' : 'English'}}"
            },
            {
              "key": "Status|select",
              "selectValue": "=Pending"
            },
            {
              "key": "Reminder Sent|checkbox"
            },
            {
              "key": "Name|rich_text",
              "textContent": "={{$json.name}}"
            },
            {
              "key": "Special Request|rich_text",
              "textContent": "={{$json.specialRequest}}"
            }
          ]
        },
        "options": {}
      },
      "id": "98c6b6dd-f139-4bb4-8e6f-7dd8e38e0dc3",
      "name": "NotionÏóê Ï†ÄÏû•",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2,
      "position": [
        800,
        304
      ],
      "credentials": {
        "notionApi": {
          "id": "AU29qZb94H2pm2jL",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "functionCode": "// Í¥ÄÎ¶¨Ïûê Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø (ÌÉúÍµ≠Ïñ¥ Í≥†Ï†ï, ÏïàÏ†Ñ Ï≤òÎ¶¨)\nconst data = items[0].json;\n\nconst branchInfo = {\n  'Ekamai': {\n    name: '‡∏™‡∏≤‡∏Ç‡∏≤‡πÄ‡∏≠‡∏Å‡∏°‡∏±‡∏¢',\n    phone: '095-868-6826',\n    address: 'BTS ‡πÄ‡∏≠‡∏Å‡∏°‡∏±‡∏¢ ‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏Å 4 ‡∏ï‡∏£‡∏á‡∏Ç‡πâ‡∏≤‡∏°‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó'\n  },\n  'Phrom Phong': {\n    name: '‡∏™‡∏≤‡∏Ç‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏û‡∏á‡∏©‡πå', \n    phone: '02-115-5500',\n    address: '‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó ‡∏ã‡∏≠‡∏¢ 24 ‡∏ä‡∏±‡πâ‡∏ô 1 ‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°‡∏≠‡∏£‡∏¥‡∏™‡∏ï‡∏±‡∏ô'\n  }\n};\n\n// ÎîîÎ≤ÑÍπÖ Ï†ïÎ≥¥\nconsole.log('=== Branch Debug ===');\nconsole.log('data.property_branch:', JSON.stringify(data.property_branch));\nconsole.log('branchInfo keys:', Object.keys(branchInfo));\n\n// ÏïàÏ†ÑÌïú ÏßÄÏ†ê Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞ (Ïò¨Î∞îÎ•∏ ÏÜçÏÑ±Î™Ö ÏÇ¨Ïö©)\nlet branch = branchInfo[data.property_branch];\nconsole.log('branch result:', branch);\n\nif (!branch) {\n  console.error('Branch not found! Available branches:', Object.keys(branchInfo));\n  console.error('Received branch:', data.property_branch);\n  \n  // Í∏∞Î≥∏Í∞í ÏÑ§Ï†ï (Ïò§Î•ò Î∞©ÏßÄ)\n  branch = {\n    name: data.property_branch + ' (Ï†ïÎ≥¥ ÏóÜÏùå)',\n    phone: 'Ïó∞ÎùΩÏ≤ò Ï†ïÎ≥¥ ÏóÜÏùå',\n    address: 'Ï£ºÏÜå Ï†ïÎ≥¥ ÏóÜÏùå'\n  };\n}\n\n// ÎÇ†Ïßú Ìè¨Îß∑ÌåÖ (Ïò¨Î∞îÎ•∏ ÏÜçÏÑ±Î™Ö ÏÇ¨Ïö©)\nconst dateFormatted = new Date(data.property_reservation_date_time.start).toLocaleString('th-TH', {\n  timeZone: 'Asia/Bangkok',\n  year: 'numeric',\n  month: '2-digit', \n  day: '2-digit',\n  hour: '2-digit',\n  minute: '2-digit'\n});\n\n// Í≥µÍ∞Ñ Ï†ïÎ≥¥ (ÏïàÏ†Ñ Ï≤òÎ¶¨)\nconst spaceInfo = data.property_space_type === 'Room' ? \n  `‡∏´‡πâ‡∏≠‡∏á - ${data.property_room_number || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}` : \n  `‡πÇ‡∏ã‡∏ô‡πÇ‡∏ï‡πä‡∏∞`;\n\n// Ïñ∏Ïñ¥ ÌëúÏãú\nconst languageDisplay = {\n  'ko': '‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ',\n  'th': '‡πÑ‡∏ó‡∏¢', \n  'en': '‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©'\n}[data.property_language] || data.property_language;\n\n// n8n Webhook URLs (URL ÌååÎùºÎØ∏ÌÑ∞ Î∞©ÏãùÏúºÎ°ú ÏàòÏ†ï)\n   const confirmUrl = `https://dylan-automation.app.n8n.cloud/webhook/bookmakgol-admin?action=confirm&id=${data.property_booking_number}`;\n   const cancelUrl = `https://dylan-automation.app.n8n.cloud/webhook/bookmakgol-admin?action=cancel&id=${data.property_booking_number}`;\n\nconst emailBody = `\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body { \n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: #2d2d2d; \n            line-height: 1.6; \n            margin: 0; \n            padding: 20px;\n            min-height: 100vh;\n        }\n        \n        .container { \n            max-width: 600px; \n            margin: 0 auto; \n            padding: 20px;\n        }\n        \n        .header { \n            text-align: center; \n            margin-bottom: 30px;\n            padding: 30px 20px;\n            background: rgba(255, 255, 255, 0.25);\n            border-radius: 20px;\n            backdrop-filter: blur(10px);\n            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);\n            border: 1px solid rgba(255, 255, 255, 0.18);\n        }\n\n        .header h1 {\n            font-size: 2.5rem;\n            font-weight: 700;\n            color: #2d2d2d;\n            margin-bottom: 10px;\n            letter-spacing: 0.5px;\n        }\n\n        .alert-badge {\n            background: linear-gradient(135deg, #ff6b6b, #ee5a52);\n            color: white;\n            padding: 8px 16px;\n            border-radius: 20px;\n            font-size: 0.9rem;\n            font-weight: 600;\n            display: inline-block;\n            margin-top: 10px;\n            box-shadow: 0 4px 15px rgba(238, 90, 82, 0.4);\n        }\n        \n        .info-box { \n            background: rgba(255, 255, 255, 0.25);\n            padding: 30px; \n            border-radius: 20px; \n            margin: 20px 0; \n            backdrop-filter: blur(10px);\n            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);\n            border: 1px solid rgba(255, 255, 255, 0.18);\n        }\n        \n        .customer-box { \n            background: rgba(255, 255, 255, 0.25);\n            padding: 30px; \n            border-radius: 20px; \n            margin: 20px 0; \n            backdrop-filter: blur(10px);\n            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);\n            border: 1px solid rgba(255, 255, 255, 0.18);\n        }\n        \n        .button-section { \n            text-align: center; \n            margin: 30px 0; \n            padding: 25px; \n            background: rgba(255, 255, 255, 0.2);\n            border-radius: 15px; \n            backdrop-filter: blur(10px);\n            border: 1px solid rgba(255, 255, 255, 0.18);\n        }\n        \n        .btn { \n            display: inline-block; \n            padding: 15px 30px; \n            margin: 0 10px; \n            text-decoration: none; \n            border-radius: 15px; \n            font-weight: 600; \n            font-size: 1rem; \n            color: white !important;\n            transition: all 0.3s ease;\n            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n            border: none;\n            cursor: pointer;\n        }\n        \n        .btn-confirm { \n            background: linear-gradient(135deg, #51cf66, #40c057);\n        }\n        \n        .btn-confirm:hover { \n            background: linear-gradient(135deg, #40c057, #37b24d);\n            transform: translateY(-2px);\n            box-shadow: 0 6px 20px rgba(64, 192, 87, 0.4);\n        }\n        \n        .btn-cancel { \n            background: linear-gradient(135deg, #ff6b6b, #ee5a52);\n        }\n        \n        .btn-cancel:hover { \n            background: linear-gradient(135deg, #ee5a52, #e03131);\n            transform: translateY(-2px);\n            box-shadow: 0 6px 20px rgba(238, 90, 82, 0.4);\n        }\n        \n        .footer { \n            color: #4a4a4a; \n            font-size: 0.9rem; \n            text-align: center; \n            margin-top: 30px; \n            padding: 20px;\n            background: rgba(255, 255, 255, 0.15);\n            border-radius: 10px;\n            backdrop-filter: blur(5px);\n            border: 1px solid rgba(255, 255, 255, 0.1);\n        }\n        \n        h2 { \n            color: #2d2d2d; \n            border-bottom: 2px solid rgba(255, 255, 255, 0.3); \n            padding-bottom: 10px;\n            margin-bottom: 20px;\n            font-size: 1.2rem;\n            font-weight: 600;\n        }\n        \n        h3 { \n            color: #2d2d2d; \n            margin-bottom: 15px;\n            font-size: 1.1rem;\n            font-weight: 600;\n        }\n        \n        strong { \n            color: #2d2d2d;\n            font-weight: 600;\n        }\n\n        p {\n            margin: 10px 0;\n            color: #3a3a3a;\n        }\n\n        @media (max-width: 768px) {\n            .container {\n                padding: 10px;\n            }\n\n            .header h1 {\n                font-size: 2rem;\n            }\n\n            .info-box, .customer-box {\n                padding: 20px;\n            }\n\n            .btn {\n                display: block;\n                margin: 10px 0;\n                width: 100%;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>üçΩÔ∏è ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤</h1>\n            <div class=\"alert-badge\">‚ö° ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</div>\n        </div>\n\n        <div class=\"info-box\">\n            <h2>üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h2>\n            <p><strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á:</strong> ${data.property_booking_number}</p>\n            <p><strong>‡∏™‡∏≤‡∏Ç‡∏≤:</strong> ${branch.name}</p>\n            <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡πÄ‡∏ß‡∏•‡∏≤:</strong> ${dateFormatted}</p>\n            <p><strong>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà:</strong> ${spaceInfo}</p>\n            <p><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô:</strong> ${data.property_guests} ‡∏ó‡πà‡∏≤‡∏ô</p>\n        </div>\n\n        <div class=\"customer-box\">\n            <h2>üë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h2>\n            <p><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ${data.property_name}</p>\n            <p><strong>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</strong> ${data.property_phone}</p>\n            <p><strong>‡∏≠‡∏µ‡πÄ‡∏°‡∏•:</strong> ${data.property_email}</p>\n            <p><strong>‡∏†‡∏≤‡∏©‡∏≤:</strong> ${languageDisplay}</p>\n            <p><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡πÄ‡∏®‡∏©:</strong> ${data.property_special_request || '‡πÑ‡∏°‡πà‡∏°‡∏µ'}</p>\n        </div>\n\n        <div class=\"button-section\">\n            <h2>‚ö° ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</h2>\n            <p style=\"margin-bottom: 25px; color: #4a4a4a; font-weight: 600;\">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ô‡∏ó‡∏µ!</p>\n            \n            <a href=\"${confirmUrl}\" class=\"btn btn-confirm\">‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</a>\n            <a href=\"${cancelUrl}\" class=\"btn btn-cancel\">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</a>\n        </div>\n\n        <div class=\"footer\">\n            <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á Bookmakgol</p>\n            <p>‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤</p>\n        </div>\n    </div>\n</body>\n</html>\n`;\n\nreturn [{\n  json: {\n    ...data,\n    adminEmailSubject: `[Bookmakgol] ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà - ${branch.name} - ${dateFormatted}`,\n    adminEmailBody: emailBody,\n    confirmUrl: confirmUrl,\n    cancelUrl: cancelUrl\n  }\n}];"
      },
      "id": "56c04305-8d60-43b1-9935-9201b9c128da",
      "name": "Í¥ÄÎ¶¨Ïûê Ïù¥Î©îÏùº ÏÉùÏÑ±",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        1008,
        304
      ]
    },
    {
      "parameters": {
        "resource": "message",
        "subject": "={{$json.adminEmailSubject}}",
        "includeHtml": true,
        "htmlMessage": "={{$json.adminEmailBody}}",
        "message": "=",
        "toList": [
          "dylan@57tb.art",
          "kurumisakamoto678@gmail.com",
          "rtnp1345@gmail.com",
          "nollnann9@gmail.com",
          "phannipha2609@gmail.com",
          "alpinemember3105@gmail.com"
        ],
        "additionalFields": {}
      },
      "id": "8d8e00ee-5a26-4f89-bd92-73df950757b6",
      "name": "Í¥ÄÎ¶¨Ïûê Ïù¥Î©îÏùº Î∞úÏÜ°",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 1,
      "position": [
        1200,
        304
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "unDkKIDCn6d2hi5Z",
          "name": "Bookmagol Gmail account"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"status\": \"success\",\n  \"bookingNumber\": \"{{$node['ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±'].json['bookingNumber']}}\",\n  \"customerName\": \"{{$node['ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±'].json['name']}}\",\n  \"branch\": \"{{$node['ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±'].json['branch']}}\",\n  \"branchPhone\": \"{{$node['ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±'].json['branch'] === 'Ekamai' ? '095-868-6826' : '02-115-5500'}}\",\n  \"date\": \"{{$node['ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±'].json['date']}}\",\n  \"time\": \"{{$node['ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±'].json['time']}}\",\n  \"spaceType\": \"{{$node['ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±'].json['spaceType']}}\",\n  \"spaceDetail\": \"{{$node['ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±'].json['roomNumber'] || $node['ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±'].json['floor'] || 'General Table'}}\",\n  \"guests\": \"{{$node['ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±'].json['guests']}}\",\n  \"language\": \"{{$node['ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±'].json['language']}}\",\n  \"message\": \"ÏòàÏïΩÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ëÏàòÎêòÏóàÏäµÎãàÎã§.\"\n}",
        "options": {}
      },
      "id": "c8bd80f0-dcb1-40bf-b08c-34a755e89843",
      "name": "ÏÑ±Í≥µ ÏùëÎãµ",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        1408,
        304
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 9 * * *"
            }
          ]
        }
      },
      "id": "2b422210-740d-4215-bf16-2a6908e3d8e5",
      "name": "Ïä§ÏºÄÏ§Ñ Ìä∏Î¶¨Í±∞",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [
        -608,
        688
      ]
    },
    {
      "parameters": {
        "functionCode": "// Calculate tomorrow's date\nconst today = new Date();\nconst tomorrow = new Date(today);\ntomorrow.setDate(tomorrow.getDate() + 1);\n\n// Convert to Bangkok timezone\nconst bangkokTime = new Intl.DateTimeFormat('en-CA', {\n  timeZone: 'Asia/Bangkok',\n  year: 'numeric',\n  month: '2-digit',\n  day: '2-digit'\n}).format(tomorrow);\n\nreturn [{\n  json: {\n    tomorrowDate: bangkokTime,\n    searchStartDate: `${bangkokTime}T00:00:00.000+07:00`,\n    searchEndDate: `${bangkokTime}T23:59:59.999+07:00`\n  }\n}];"
      },
      "id": "f1865259-6768-47cb-9959-5898b7f92d98",
      "name": "ÎÇ¥Ïùº ÎÇ†Ïßú Í≥ÑÏÇ∞",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        -400,
        688
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "284a2fb1-c15d-81a1-9d93-d4f47300f2e3",
          "mode": "list",
          "cachedResultName": "Bookmakgol Reservation Management",
          "cachedResultUrl": "https://www.notion.so/284a2fb1c15d81a19d93d4f47300f2e3"
        },
        "returnAll": true,
        "filterType": "manual",
        "matchType": "allFilters",
        "filters": {
          "conditions": [
            {
              "key": "Reservation DateTime|date",
              "condition": "on_or_after",
              "date": "={{$json.searchStartDate}}"
            },
            {
              "key": "Reservation DateTime|date",
              "condition": "on_or_before",
              "date": "={{$json.searchEndDate}}"
            },
            {
              "key": "Status|select",
              "condition": "equals",
              "selectValue": "=Confirmed"
            },
            {
              "key": "Reminder Sent|checkbox",
              "condition": "equals"
            }
          ]
        },
        "options": {}
      },
      "id": "c55704c7-7bd9-4d7b-92cf-d46e3d342e00",
      "name": "ÎÇ¥Ïùº ÏòàÏïΩ Ï°∞Ìöå",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2,
      "position": [
        -208,
        688
      ],
      "credentials": {
        "notionApi": {
          "id": "AU29qZb94H2pm2jL",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{$json.length}}",
              "operation": "larger"
            }
          ]
        }
      },
      "id": "a584afe0-90ab-4970-a40f-f7733f92d816",
      "name": "ÏòàÏïΩ Ï°¥Ïû¨ ÌôïÏù∏",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        0,
        688
      ]
    },
    {
      "parameters": {
        "functionCode": "// Prepare reminder data (data is already extracted from Notion)\nconst reservations = items.map(item => {\n  const data = item.json;\n  \n  // Data is already in property_* format\n  const bookingNumber = data.property_booking_num || data.property_booking_number;\n  const pageId = data.id;\n  const language = data.property_language;\n  const langCode = language === 'Korean' ? 'ko' : language === 'Thai' ? 'th' : 'en';\n  \n  // Parse date\n  const dateTime = new Date(data.property_reservation_date_time?.start || data.start);\n  \n  const dateFormatted = dateTime.toLocaleDateString(\n    langCode === 'ko' ? 'ko-KR' : langCode === 'th' ? 'th-TH' : 'en-US',\n    {\n      timeZone: 'Asia/Bangkok',\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      weekday: 'long'\n    }\n  );\n  \n  const timeFormatted = dateTime.toLocaleTimeString('en-US', {\n    timeZone: 'Asia/Bangkok',\n    hour: '2-digit',\n    minute: '2-digit',\n    hour12: false\n  });\n  \n  // Branch information\n  const branchName = data.property_branch;\n  const branchInfo = {\n    'Ekamai': {\n      ko: { name: 'ÏóêÍπåÎßàÏù¥ ÏßÄÏ†ê', address: 'BTS ÏóêÍπåÎßàÏù¥Ïó≠ 4Î≤à Ï∂úÍµ¨, ÏàòÏø∞Ïúó Î≥ëÏõê ÎßûÏùÄÌé∏', phone: '095-868-6826' },\n      th: { name: '‡∏™‡∏≤‡∏Ç‡∏≤‡πÄ‡∏≠‡∏Å‡∏°‡∏±‡∏¢', address: 'BTS ‡πÄ‡∏≠‡∏Å‡∏°‡∏±‡∏¢ ‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏Å 4 ‡∏ï‡∏£‡∏á‡∏Ç‡πâ‡∏≤‡∏°‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó', phone: '095-868-6826' },\n      en: { name: 'Ekamai Branch', address: 'BTS Ekamai Exit 4, Opposite Sukhumvit Hospital', phone: '095-868-6826' }\n    },\n    'Phrom Phong': {\n      ko: { name: 'ÌîÑÎ°¨ÌêÅ ÏßÄÏ†ê', address: 'ÏàòÏø∞Ïúó ÏÜåÏù¥ 24, ÏïÑÎ¶¨Ïä§ÌÜ§ Ìò∏ÌÖî 1Ï∏µ', phone: '02-115-5500' },\n      th: { name: '‡∏™‡∏≤‡∏Ç‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏û‡∏á‡∏©‡πå', address: '‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó ‡∏ã‡∏≠‡∏¢ 24 ‡∏ä‡∏±‡πâ‡∏ô 1 ‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°‡∏≠‡∏£‡∏¥‡∏™‡∏ï‡∏±‡∏ô', phone: '02-115-5500' },\n      en: { name: 'Phrom Phong Branch', address: 'Sukhumvit Soi 24, Ariston Hotel 1st Floor', phone: '02-115-5500' }\n    }\n  };\n  \n  const branch = branchInfo[branchName]?.[langCode] || branchInfo['Ekamai'][langCode];\n  \n  // Space info\n  const spaceType = data.property_space_type;\n  const roomNumber = data.property_room_number;\n  const spaceInfo = spaceType === 'Room' ? `Room ${roomNumber}` : 'Table';\n  \n  // Google Maps\n  const googleMapsLink = branchName === 'Ekamai' \n    ? 'https://maps.app.goo.gl/xb1Q4SW4fYd56FoYA'\n    : 'https://maps.app.goo.gl/PXyJGvjZcZu68RUL9';\n  \n  return {\n    pageId,\n    bookingNumber,\n    name: data.property_name,\n    email: data.property_email,\n    language: langCode,\n    dateFormatted,\n    timeFormatted,\n    branch: branchName,\n    branchInfo: branch,\n    spaceInfo,\n    guests: data.property_guests || 0,\n    specialRequest: data.property_special_request || '',\n    googleMapsLink\n  };\n});\n\nreturn reservations.map(reservation => ({ json: reservation }));"
      },
      "id": "917dc768-088a-4bbb-b8eb-b15dd092d3ea",
      "name": "Î¶¨ÎßàÏù∏Îçî Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        192,
        592
      ]
    },
    {
      "parameters": {
        "functionCode": "// Î¶¨ÎßàÏù∏Îçî Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø ÏÉùÏÑ± (Î™®Îì† ÏïÑÏù¥ÌÖú Ï≤òÎ¶¨)\nconst results = items.map(item => {\n  const data = item.json;\n\n  // Ïñ∏Ïñ¥Î≥Ñ ÌÖúÌîåÎ¶ø\n  const templates = {\n    ko: {\n      subject: `[Bookmakgol] ÎÇ¥Ïùº ÏòàÏïΩ ÏïàÎÇ¥ - ${data.bookingNumber}`,\n      body: `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n      background: linear-gradient(to bottom, #b0b0b0 0%, #9a9a9a 100%);\n      padding: 20px;\n      line-height: 1.6;\n    }\n    .container {\n      max-width: 600px;\n      margin: 0 auto;\n      background: rgba(255, 255, 255, 0.5);\n      border-radius: 20px;\n      padding: 30px;\n      backdrop-filter: blur(10px);\n      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n      border: 1px solid rgba(255, 255, 255, 0.3);\n    }\n    .header {\n      text-align: center;\n      margin-bottom: 30px;\n      padding: 20px;\n      background: rgba(255, 255, 255, 0.3);\n      border-radius: 15px;\n      backdrop-filter: blur(5px);\n    }\n    .logo {\n      font-size: 2rem;\n      font-weight: 700;\n      color: #2d2d2d;\n      margin-bottom: 10px;\n    }\n    .subtitle {\n      font-size: 1.1rem;\n      color: #4a4a4a;\n      font-weight: 600;\n    }\n    .section {\n      background: rgba(255, 255, 255, 0.4);\n      border-radius: 15px;\n      padding: 20px;\n      margin: 20px 0;\n      backdrop-filter: blur(5px);\n      border: 1px solid rgba(255, 255, 255, 0.3);\n    }\n    .section-title {\n      font-size: 1.2rem;\n      color: #2d2d2d;\n      margin-bottom: 15px;\n      padding-bottom: 8px;\n      border-bottom: 2px solid #c8c8c8;\n      display: flex;\n      align-items: center;\n      font-weight: 600;\n    }\n    .section-number {\n      color: #2d2d2d;\n      font-size: 1.2rem;\n      margin-right: 10px;\n    }\n    .info-row {\n      display: flex;\n      justify-content: space-between;\n      padding: 10px 0;\n      border-bottom: 1px solid rgba(200, 200, 200, 0.3);\n    }\n    .info-row:last-child { border-bottom: none; }\n    .info-label {\n      font-weight: 600;\n      color: #3a3a3a;\n    }\n    .info-value {\n      color: #2d2d2d;\n      text-align: right;\n    }\n    .map-btn {\n      display: inline-block;\n      width: 100%;\n      padding: 15px;\n      margin: 15px 0;\n      background: rgba(74, 74, 74, 0.9);\n      color: white;\n      text-decoration: none;\n      border-radius: 12px;\n      text-align: center;\n      font-weight: 600;\n      font-size: 1rem;\n      transition: all 0.3s ease;\n      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n    }\n    .map-btn:hover {\n      background: rgba(45, 45, 45, 1);\n      transform: translateY(-2px);\n      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);\n    }\n    .highlight-box {\n      background: rgba(74, 74, 74, 0.1);\n      border-left: 4px solid #4a4a4a;\n      padding: 15px;\n      margin: 15px 0;\n      border-radius: 8px;\n    }\n    .footer {\n      text-align: center;\n      margin-top: 30px;\n      padding-top: 20px;\n      border-top: 2px solid rgba(200, 200, 200, 0.5);\n      color: #666;\n      font-size: 0.9rem;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"header\">\n      <div class=\"logo\">üçΩÔ∏è Î∂ÅÎßâÍ≥®</div>\n      <div class=\"subtitle\">ÎÇ¥Ïùº ÏòàÏïΩ ÏïàÎÇ¥</div>\n    </div>\n\n    <div class=\"section\">\n      <div class=\"section-title\">\n        <span class=\"section-number\">üìã</span>\n        ÏòàÏïΩ Ï†ïÎ≥¥\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">ÏòàÏïΩÎ≤àÌò∏:</div>\n        <div class=\"info-value\">${data.bookingNumber}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">Í≥†Í∞ùÎ™Ö:</div>\n        <div class=\"info-value\">${data.name}</div>\n      </div>\n    </div>\n\n    <div class=\"section\">\n      <div class=\"section-title\">\n        <span class=\"section-number\">üìç</span>\n        Î∞©Î¨∏ Ï†ïÎ≥¥\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">ÏßÄÏ†ê:</div>\n        <div class=\"info-value\">${data.branchInfo.name}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">ÎÇ†Ïßú:</div>\n        <div class=\"info-value\">${data.dateFormatted}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">ÏãúÍ∞Ñ:</div>\n        <div class=\"info-value\">${data.timeFormatted}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">Í≥µÍ∞Ñ:</div>\n        <div class=\"info-value\">${data.spaceInfo}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">Ïù∏Ïõê:</div>\n        <div class=\"info-value\">${data.guests}Î™Ö</div>\n      </div>\n    </div>\n\n    <div class=\"section\">\n      <div class=\"section-title\">\n        <span class=\"section-number\">üß≠</span>\n        Ïò§ÏãúÎäî Í∏∏\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">Ï£ºÏÜå:</div>\n        <div class=\"info-value\">${data.branchInfo.address}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">Ï†ÑÌôî:</div>\n        <div class=\"info-value\">${data.branchInfo.phone}</div>\n      </div>\n      <a href=\"${data.googleMapsLink}\" class=\"map-btn\">\n        üìç Íµ¨Í∏ÄÎßµÏúºÎ°ú Í∏∏Ï∞æÍ∏∞\n      </a>\n    </div>\n\n    <div class=\"highlight-box\">\n      <strong>‚è∞ ÏòàÏïΩ ÏãúÍ∞Ñ 10Î∂Ñ Ï†ÑÍπåÏßÄ ÎèÑÏ∞©Ìï¥Ï£ºÏÑ∏Ïöî!</strong><br>\n      Î¨∏ÏùòÏÇ¨Ìï≠Ïù¥ ÏûàÏúºÏãúÎ©¥ ÏúÑ Ï†ÑÌôîÎ≤àÌò∏Î°ú Ïó∞ÎùΩÏ£ºÏÑ∏Ïöî.\n    </div>\n\n    <div class=\"footer\">\n      Î∂ÅÎßâÍ≥® ÏòàÏïΩ ÏãúÏä§ÌÖú<br>\n      ÌÉúÍµ≠ Ï†ÑÌÜµ ÌïúÏãùÎãπ\n    </div>\n  </div>\n</body>\n</html>\n      `\n    },\n    th: {\n      subject: `[Bookmakgol] ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ - ${data.bookingNumber}`,\n      body: `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n      background: linear-gradient(to bottom, #b0b0b0 0%, #9a9a9a 100%);\n      padding: 20px;\n      line-height: 1.6;\n    }\n    .container {\n      max-width: 600px;\n      margin: 0 auto;\n      background: rgba(255, 255, 255, 0.5);\n      border-radius: 20px;\n      padding: 30px;\n      backdrop-filter: blur(10px);\n      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n      border: 1px solid rgba(255, 255, 255, 0.3);\n    }\n    .header {\n      text-align: center;\n      margin-bottom: 30px;\n      padding: 20px;\n      background: rgba(255, 255, 255, 0.3);\n      border-radius: 15px;\n      backdrop-filter: blur(5px);\n    }\n    .logo {\n      font-size: 2rem;\n      font-weight: 700;\n      color: #2d2d2d;\n      margin-bottom: 10px;\n    }\n    .subtitle {\n      font-size: 1.1rem;\n      color: #4a4a4a;\n      font-weight: 600;\n    }\n    .section {\n      background: rgba(255, 255, 255, 0.4);\n      border-radius: 15px;\n      padding: 20px;\n      margin: 20px 0;\n      backdrop-filter: blur(5px);\n      border: 1px solid rgba(255, 255, 255, 0.3);\n    }\n    .section-title {\n      font-size: 1.2rem;\n      color: #2d2d2d;\n      margin-bottom: 15px;\n      padding-bottom: 8px;\n      border-bottom: 2px solid #c8c8c8;\n      display: flex;\n      align-items: center;\n      font-weight: 600;\n    }\n    .section-number {\n      color: #2d2d2d;\n      font-size: 1.2rem;\n      margin-right: 10px;\n    }\n    .info-row {\n      display: flex;\n      justify-content: space-between;\n      padding: 10px 0;\n      border-bottom: 1px solid rgba(200, 200, 200, 0.3);\n    }\n    .info-row:last-child { border-bottom: none; }\n    .info-label {\n      font-weight: 600;\n      color: #3a3a3a;\n    }\n    .info-value {\n      color: #2d2d2d;\n      text-align: right;\n    }\n    .map-btn {\n      display: inline-block;\n      width: 100%;\n      padding: 15px;\n      margin: 15px 0;\n      background: rgba(74, 74, 74, 0.9);\n      color: white;\n      text-decoration: none;\n      border-radius: 12px;\n      text-align: center;\n      font-weight: 600;\n      font-size: 1rem;\n      transition: all 0.3s ease;\n      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n    }\n    .map-btn:hover {\n      background: rgba(45, 45, 45, 1);\n      transform: translateY(-2px);\n      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);\n    }\n    .highlight-box {\n      background: rgba(74, 74, 74, 0.1);\n      border-left: 4px solid #4a4a4a;\n      padding: 15px;\n      margin: 15px 0;\n      border-radius: 8px;\n    }\n    .footer {\n      text-align: center;\n      margin-top: 30px;\n      padding-top: 20px;\n      border-top: 2px solid rgba(200, 200, 200, 0.5);\n      color: #666;\n      font-size: 0.9rem;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"header\">\n      <div class=\"logo\">üçΩÔ∏è ‡∏ö‡∏∏‡∏Å‡∏°‡∏±‡∏Å‡∏Å‡∏•</div>\n      <div class=\"subtitle\">‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ</div>\n    </div>\n\n    <div class=\"section\">\n      <div class=\"section-title\">\n        <span class=\"section-number\">üìã</span>\n        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á:</div>\n        <div class=\"info-value\">${data.bookingNumber}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</div>\n        <div class=\"info-value\">${data.name}</div>\n      </div>\n    </div>\n\n    <div class=\"section\">\n      <div class=\"section-title\">\n        <span class=\"section-number\">üìç</span>\n        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">‡∏™‡∏≤‡∏Ç‡∏≤:</div>\n        <div class=\"info-value\">${data.branchInfo.name}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</div>\n        <div class=\"info-value\">${data.dateFormatted}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">‡πÄ‡∏ß‡∏•‡∏≤:</div>\n        <div class=\"info-value\">${data.timeFormatted}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà:</div>\n        <div class=\"info-value\">${data.spaceInfo}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô:</div>\n        <div class=\"info-value\">${data.guests} ‡∏ó‡πà‡∏≤‡∏ô</div>\n      </div>\n    </div>\n\n    <div class=\"section\">\n      <div class=\"section-title\">\n        <span class=\"section-number\">üß≠</span>\n        ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</div>\n        <div class=\"info-value\">${data.branchInfo.address}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</div>\n        <div class=\"info-value\">${data.branchInfo.phone}</div>\n      </div>\n      <a href=\"${data.googleMapsLink}\" class=\"map-btn\">\n        üìç ‡πÄ‡∏õ‡∏¥‡∏î Google Maps\n      </a>\n    </div>\n\n    <div class=\"highlight-box\">\n      <strong>‚è∞ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢ 10 ‡∏ô‡∏≤‡∏ó‡∏µ!</strong><br>\n      ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÇ‡∏ó‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô\n    </div>\n\n    <div class=\"footer\">\n      ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡πÇ‡∏ï‡πä‡∏∞ Bookmakgol<br>\n      ‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ‡∏î‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢\n    </div>\n  </div>\n</body>\n</html>\n      `\n    },\n    en: {\n      subject: `[Bookmakgol] Tomorrow's Reservation Reminder - ${data.bookingNumber}`,\n      body: `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n      background: linear-gradient(to bottom, #b0b0b0 0%, #9a9a9a 100%);\n      padding: 20px;\n      line-height: 1.6;\n    }\n    .container {\n      max-width: 600px;\n      margin: 0 auto;\n      background: rgba(255, 255, 255, 0.5);\n      border-radius: 20px;\n      padding: 30px;\n      backdrop-filter: blur(10px);\n      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n      border: 1px solid rgba(255, 255, 255, 0.3);\n    }\n    .header {\n      text-align: center;\n      margin-bottom: 30px;\n      padding: 20px;\n      background: rgba(255, 255, 255, 0.3);\n      border-radius: 15px;\n      backdrop-filter: blur(5px);\n    }\n    .logo {\n      font-size: 2rem;\n      font-weight: 700;\n      color: #2d2d2d;\n      margin-bottom: 10px;\n    }\n    .subtitle {\n      font-size: 1.1rem;\n      color: #4a4a4a;\n      font-weight: 600;\n    }\n    .section {\n      background: rgba(255, 255, 255, 0.4);\n      border-radius: 15px;\n      padding: 20px;\n      margin: 20px 0;\n      backdrop-filter: blur(5px);\n      border: 1px solid rgba(255, 255, 255, 0.3);\n    }\n    .section-title {\n      font-size: 1.2rem;\n      color: #2d2d2d;\n      margin-bottom: 15px;\n      padding-bottom: 8px;\n      border-bottom: 2px solid #c8c8c8;\n      display: flex;\n      align-items: center;\n      font-weight: 600;\n    }\n    .section-number {\n      color: #2d2d2d;\n      font-size: 1.2rem;\n      margin-right: 10px;\n    }\n    .info-row {\n      display: flex;\n      justify-content: space-between;\n      padding: 10px 0;\n      border-bottom: 1px solid rgba(200, 200, 200, 0.3);\n    }\n    .info-row:last-child { border-bottom: none; }\n    .info-label {\n      font-weight: 600;\n      color: #3a3a3a;\n    }\n    .info-value {\n      color: #2d2d2d;\n      text-align: right;\n    }\n    .map-btn {\n      display: inline-block;\n      width: 100%;\n      padding: 15px;\n      margin: 15px 0;\n      background: rgba(74, 74, 74, 0.9);\n      color: white;\n      text-decoration: none;\n      border-radius: 12px;\n      text-align: center;\n      font-weight: 600;\n      font-size: 1rem;\n      transition: all 0.3s ease;\n      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n    }\n    .map-btn:hover {\n      background: rgba(45, 45, 45, 1);\n      transform: translateY(-2px);\n      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);\n    }\n    .highlight-box {\n      background: rgba(74, 74, 74, 0.1);\n      border-left: 4px solid #4a4a4a;\n      padding: 15px;\n      margin: 15px 0;\n      border-radius: 8px;\n    }\n    .footer {\n      text-align: center;\n      margin-top: 30px;\n      padding-top: 20px;\n      border-top: 2px solid rgba(200, 200, 200, 0.5);\n      color: #666;\n      font-size: 0.9rem;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"header\">\n      <div class=\"logo\">üçΩÔ∏è Bookmakgol</div>\n      <div class=\"subtitle\">Tomorrow's Reservation Reminder</div>\n    </div>\n\n    <div class=\"section\">\n      <div class=\"section-title\">\n        <span class=\"section-number\">üìã</span>\n        Reservation Details\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">Booking Number:</div>\n        <div class=\"info-value\">${data.bookingNumber}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">Customer Name:</div>\n        <div class=\"info-value\">${data.name}</div>\n      </div>\n    </div>\n\n    <div class=\"section\">\n      <div class=\"section-title\">\n        <span class=\"section-number\">üìç</span>\n        Visit Information\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">Branch:</div>\n        <div class=\"info-value\">${data.branchInfo.name}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">Date:</div>\n        <div class=\"info-value\">${data.dateFormatted}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">Time:</div>\n        <div class=\"info-value\">${data.timeFormatted}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">Space:</div>\n        <div class=\"info-value\">${data.spaceInfo}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">Guests:</div>\n        <div class=\"info-value\">${data.guests}</div>\n      </div>\n    </div>\n\n    <div class=\"section\">\n      <div class=\"section-title\">\n        <span class=\"section-number\">üß≠</span>\n        Directions\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">Address:</div>\n        <div class=\"info-value\">${data.branchInfo.address}</div>\n      </div>\n      <div class=\"info-row\">\n        <div class=\"info-label\">Phone:</div>\n        <div class=\"info-value\">${data.branchInfo.phone}</div>\n      </div>\n      <a href=\"${data.googleMapsLink}\" class=\"map-btn\">\n        üìç Open Google Maps\n      </a>\n    </div>\n\n    <div class=\"highlight-box\">\n      <strong>‚è∞ Please arrive 10 minutes before your reservation!</strong><br>\n      If you have any questions, please call the number above.\n    </div>\n\n    <div class=\"footer\">\n      Bookmakgol Reservation System<br>\n      Traditional Korean Restaurant in Thailand\n    </div>\n  </div>\n</body>\n</html>\n      `\n    }\n  };\n\n  const template = templates[data.language];\n\n  return {\n    json: {\n      ...data,\n      emailSubject: template.subject,\n      emailBody: template.body\n    }\n  };\n});\n\nreturn results;"
      },
      "id": "625ea4d9-63aa-474b-b48a-9e33162aefc3",
      "name": "Î¶¨ÎßàÏù∏Îçî ÌÖúÌîåÎ¶ø ÏÉùÏÑ±",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        400,
        592
      ]
    },
    {
      "parameters": {
        "resource": "message",
        "subject": "={{$json.emailSubject}}",
        "includeHtml": true,
        "htmlMessage": "={{$json.emailBody}}",
        "message": "=",
        "toList": [
          "={{$json.email}}"
        ],
        "additionalFields": {}
      },
      "id": "65f33762-79a7-4a51-898b-fd0ef4fb5cf4",
      "name": "Î¶¨ÎßàÏù∏Îçî Ïù¥Î©îÏùº Î∞úÏÜ°",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 1,
      "position": [
        592,
        592
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "unDkKIDCn6d2hi5Z",
          "name": "Bookmagol Gmail account"
        }
      }
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "update",
        "pageId": {
          "__rl": true,
          "value": "={{ $('Î¶¨ÎßàÏù∏Îçî ÌÖúÌîåÎ¶ø ÏÉùÏÑ±').item.json.pageId }}",
          "mode": "id"
        },
        "simple": false,
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Reminder Sent|checkbox",
              "checkboxValue": true
            }
          ]
        },
        "options": {}
      },
      "id": "74eedb55-be7e-4c31-bc6c-03e36290df64",
      "name": "Î¶¨ÎßàÏù∏Îçî Î∞úÏÜ° ÌëúÏãú",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2,
      "position": [
        800,
        592
      ],
      "credentials": {
        "notionApi": {
          "id": "AU29qZb94H2pm2jL",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "functionCode": "// Processing completion log\nconst processedCount = items.length;\nconst currentTime = new Date().toLocaleString('en-US', {\n  timeZone: 'Asia/Bangkok'\n});\n\nconsole.log(`[${currentTime}] Reminder sending completed: ${processedCount} items`);\n\nreturn [{\n  json: {\n    processedCount,\n    processedAt: currentTime,\n    message: `Successfully sent ${processedCount} reminders.`\n  }\n}];"
      },
      "id": "605a514e-0f33-413c-90b5-27a81911782e",
      "name": "Ï≤òÎ¶¨ ÏôÑÎ£å Î°úÍ∑∏",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        992,
        592
      ]
    },
    {
      "parameters": {
        "path": "bookmakgol-admin",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "74197144-8134-4374-a022-bbf8446dbe7b",
      "name": "Í¥ÄÎ¶¨Ïûê Î≤ÑÌäº Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [
        -608,
        1072
      ],
      "webhookId": "bookmakgol-admin"
    },
    {
      "parameters": {
        "functionCode": "// ========== Ï§ëÎ≥µ Ïã§Ìñâ Î∞©ÏßÄ ÏãúÏûë ==========\n// URL ÌååÎùºÎØ∏ÌÑ∞ Î®ºÏ†Ä ÌååÏã± (Ï§ëÎ≥µ Ï≤¥ÌÅ¨Ïö©)\nconst webhookData = items[0].json;\nconst query = webhookData.query || {};\nconst action = query.action || 'cancel';\nconst bookingId = query.id;\n\n// Ï§ëÎ≥µ Ïã§Ìñâ Î∞©ÏßÄ Î°úÏßÅ\nconst now = Date.now();\nconst cacheKey = `processed_${bookingId}_${action}`;\n\nif (!global.processedBookings) {\n  global.processedBookings = {};\n}\n\n// ÏµúÍ∑º 1Î∂Ñ Ïù¥ÎÇ¥ Í∞ôÏùÄ ÏöîÏ≤≠Ïù¥ ÏûàÏóàÎäîÏßÄ Ï≤¥ÌÅ¨\nif (global.processedBookings[cacheKey]) {\n  const lastProcessed = global.processedBookings[cacheKey];\n  if (now - lastProcessed < 60000) { // 1Î∂Ñ = 60,000ms\n    const waitSeconds = Math.ceil((60000 - (now - lastProcessed)) / 1000);\n    console.log(`‚ö†Ô∏è Duplicate request detected! Please wait ${waitSeconds} seconds.`);\n    return [{\n      json: {\n        error: true,\n        message: `This booking was just processed. Please wait ${waitSeconds} seconds before trying again.`\n      }\n    }];\n  }\n}\n\n// Ï≤òÎ¶¨ Í∏∞Î°ù\nglobal.processedBookings[cacheKey] = now;\nconsole.log('‚úÖ New request accepted:', cacheKey);\n// ========== Ï§ëÎ≥µ Ïã§Ìñâ Î∞©ÏßÄ ÎÅù ==========\n\n// URL ÌååÎùºÎØ∏ÌÑ∞ ÌååÏã± Î∞è Ïï°ÏÖò Í≤∞Ï†ï\nconst bookingNumber = query.id;\n\nconsole.log('=== Debug Info ===');\nconsole.log('webhookData:', JSON.stringify(webhookData, null, 2));\nconsole.log('query:', JSON.stringify(query, null, 2));\nconsole.log('action:', action);\nconsole.log('bookingNumber:', bookingNumber);\n\nif (!bookingNumber) {\n  return [{\n    json: {\n      error: true,\n      message: 'Booking ID is required'\n    }\n  }];\n}\n\nreturn [{\n  json: {\n    action: action,\n    bookingNumber: bookingNumber,\n    error: false\n  }\n}];"
      },
      "id": "7b31bbe2-f160-48a9-851d-ad963718b8d7",
      "name": "Ïï°ÏÖò ÌååÏã±",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        -400,
        1072
      ]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{$json.error}}",
              "value2": true
            }
          ]
        }
      },
      "id": "73923010-2f2f-40f8-92cb-8d0bd2afeb1f",
      "name": "Ïò§Î•ò Ï≤¥ÌÅ¨",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        -208,
        1072
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": "284a2fb1-c15d-81a1-9d93-d4f47300f2e3",
        "limit": 1,
        "filterType": "manual",
        "matchType": "allFilters",
        "filters": {
          "conditions": [
            {
              "key": "Booking Number|title",
              "condition": "equals",
              "titleValue": "={{$json.bookingNumber}}"
            }
          ]
        },
        "options": {}
      },
      "id": "7c737cb9-1613-4a67-9609-5b8ab5709dcc",
      "name": "ÏòàÏïΩ Ï°∞Ìöå",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2,
      "position": [
        0,
        1168
      ],
      "credentials": {
        "notionApi": {
          "id": "AU29qZb94H2pm2jL",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "html",
        "options": {}
      },
      "id": "badc7eab-75dd-4818-a133-52e87990f58c",
      "name": "ÏòàÏïΩ ÏóÜÏùå ÏùëÎãµ",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        400,
        1088
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$node['Ïï°ÏÖò ÌååÏã±'].json.action}}",
              "value2": "confirm"
            }
          ]
        }
      },
      "id": "ffc77e7b-2824-462c-97b8-5977df10b48d",
      "name": "Ïï°ÏÖò Î∂ÑÍ∏∞",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        400,
        1280
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "update",
        "pageId": {
          "__rl": true,
          "value": "={{$json.id}}",
          "mode": "id"
        },
        "simple": false,
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Status|select",
              "selectValue": "Confirmed"
            }
          ]
        },
        "options": {}
      },
      "id": "8a1c1c42-1de1-4d65-adba-f333471d6c25",
      "name": "ÏòàÏïΩ ÌôïÏ†ï ÏóÖÎç∞Ïù¥Ìä∏",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2,
      "position": [
        736,
        1168
      ],
      "credentials": {
        "notionApi": {
          "id": "AU29qZb94H2pm2jL",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "update",
        "pageId": {
          "__rl": true,
          "value": "={{$json.id}}",
          "mode": "id"
        },
        "simple": false,
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Status|select",
              "selectValue": "Cancelled"
            }
          ]
        },
        "options": {}
      },
      "id": "5ab8ed6e-3997-465f-86c5-f168ed4377c6",
      "name": "ÏòàÏïΩ Ï∑®ÏÜå ÏóÖÎç∞Ïù¥Ìä∏",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2,
      "position": [
        720,
        1392
      ],
      "credentials": {
        "notionApi": {
          "id": "AU29qZb94H2pm2jL",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "functionCode": "// Í≥†Í∞ù Ï†ïÎ≥¥ Ï∂îÏ∂ú Î∞è Ïù¥Î©îÏùº Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ\nconst data = items[0].json;\nconst properties = data.properties;\n\n// Í∏∞Î≥∏ Ï†ïÎ≥¥ Ï∂îÏ∂ú\nconst bookingNumber = properties['Booking Number'].title[0].plain_text;\n\n// ÎÇ†Ïßú ÌååÏã± Í∞úÏÑ†\nconst reservationDateTime = properties['Reservation DateTime'].date.start;\nconsole.log('Original date string:', reservationDateTime);\n\nlet dateTime;\ntry {\n  if (reservationDateTime.includes('T')) {\n    dateTime = new Date(reservationDateTime);\n  } else {\n    dateTime = new Date(reservationDateTime + 'T00:00:00');\n  }\n  \n  if (isNaN(dateTime.getTime())) {\n    dateTime = new Date();\n    dateTime.setDate(dateTime.getDate() + 1);\n    console.log('Using tomorrow as fallback');\n  }\n} catch (error) {\n  console.log('Date parsing error:', error);\n  dateTime = new Date();\n  dateTime.setDate(dateTime.getDate() + 1);\n}\n\nconsole.log('Final parsed dateTime:', dateTime);\n\nconst branchName = properties['Branch'].select.name;\nconst spaceType = properties['Space Type'].select.name;\nconst roomNumber = properties['Room Number']?.select?.name;\nconst floor = properties['Floor']?.select?.name;\nconst guests = properties['Guests'].number;\nconst name = properties['Name'].rich_text[0].plain_text;\nconst email = properties['Email'].email;\nconst language = properties['Language'].select.name;\nconst specialRequest = properties['Special Request']?.rich_text[0]?.plain_text || '';\n\n// Ïñ∏Ïñ¥Î≥Ñ ÏÑ§Ï†ï\nconst langCode = language === 'Korean' ? 'ko' : language === 'Thai' ? 'th' : 'en';\n\n// ÎÇ†ÏßúÏôÄ ÏãúÍ∞Ñ Ìè¨Îß∑ÌåÖ\nconst dateFormatted = {\n  ko: dateTime.toLocaleDateString('ko-KR', { \n    timeZone: 'Asia/Bangkok',\n    year: 'numeric', \n    month: 'long', \n    day: 'numeric',\n    weekday: 'long'\n  }),\n  th: dateTime.toLocaleDateString('th-TH', { \n    timeZone: 'Asia/Bangkok',\n    year: 'numeric', \n    month: 'long', \n    day: 'numeric'\n  }),\n  en: dateTime.toLocaleDateString('en-US', { \n    timeZone: 'Asia/Bangkok',\n    year: 'numeric', \n    month: 'long', \n    day: 'numeric',\n    weekday: 'long'\n  })\n};\n\nconst timeFormatted = {\n  ko: dateTime.toLocaleTimeString('ko-KR', { \n    timeZone: 'Asia/Bangkok',\n    hour: '2-digit', \n    minute: '2-digit',\n    hour12: false\n  }),\n  th: dateTime.toLocaleTimeString('th-TH', { \n    timeZone: 'Asia/Bangkok',\n    hour: '2-digit', \n    minute: '2-digit',\n    hour12: false\n  }),\n  en: dateTime.toLocaleTimeString('en-US', { \n    timeZone: 'Asia/Bangkok',\n    hour: '2-digit', \n    minute: '2-digit',\n    hour12: false\n  })\n};\n\n// Í≥µÍ∞Ñ Ï†ïÎ≥¥\nlet spaceInfo;\nif (spaceType === 'Room') {\n  if (floor && floor !== 'undefined') {\n    spaceInfo = `${roomNumber} (${floor})`;\n  } else {\n    spaceInfo = roomNumber || 'Room';\n  }\n} else {\n  // Ïñ∏Ïñ¥Î≥Ñ ÌÖåÏù¥Î∏î Í≥µÍ∞Ñ Ï†ïÎ≥¥\n  const tableSpaceMap = {\n    'ko': 'ÏùºÎ∞ò ÌÖåÏù¥Î∏î',\n    'th': '‡πÇ‡∏ã‡∏ô‡πÇ‡∏ï‡πä‡∏∞',\n    'en': 'General Table'\n  };\n  spaceInfo = tableSpaceMap[langCode] || '‡πÇ‡∏ã‡∏ô‡πÇ‡∏ï‡πä‡∏∞';\n}\n\n// Ïñ∏Ïñ¥Î≥Ñ ÏßÄÏ†ê Ï†ïÎ≥¥\nconst branchInfo = {\n  'Ekamai': { \n    ko: { \n      name: 'ÏóêÍπåÎßàÏù¥ ÏßÄÏ†ê', \n      phone: '095-868-6826', \n      address: 'BTS ÏóêÍπåÎßàÏù¥Ïó≠ 4Î≤à Ï∂úÍµ¨, ÏàòÏø∞Ïúó Î≥ëÏõê ÎßûÏùÄÌé∏'\n    },\n    th: { \n      name: '‡∏™‡∏≤‡∏Ç‡∏≤‡πÄ‡∏≠‡∏Å‡∏°‡∏±‡∏¢', \n      phone: '095-868-6826', \n      address: 'BTS ‡πÄ‡∏≠‡∏Å‡∏°‡∏±‡∏¢ ‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏Å 4 ‡∏ï‡∏£‡∏á‡∏Ç‡πâ‡∏≤‡∏°‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó'\n    },\n    en: { \n      name: 'Ekamai Branch', \n      phone: '095-868-6826', \n      address: 'BTS Ekamai Exit 4, Opposite Sukhumvit Hospital'\n    }\n  },\n  'Phrom Phong': { \n    ko: { \n      name: 'ÌîÑÎ°¨ÌêÅ ÏßÄÏ†ê', \n      phone: '02-115-5500', \n      address: 'ÏàòÏø∞Ïúó ÏÜåÏù¥ 24, ÏïÑÎ¶¨Ïä§ÌÜ§ Ìò∏ÌÖî 1Ï∏µ'\n    },\n    th: { \n      name: '‡∏™‡∏≤‡∏Ç‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏û‡∏á‡∏©‡πå', \n      phone: '02-115-5500', \n      address: '‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó ‡∏ã‡∏≠‡∏¢ 24 ‡∏ä‡∏±‡πâ‡∏ô 1 ‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°‡∏≠‡∏£‡∏¥‡∏™‡∏ï‡∏±‡∏ô'\n    },\n    en: { \n      name: 'Phrom Phong Branch', \n      phone: '02-115-5500', \n      address: 'Sukhumvit Soi 24, Ariston Hotel 1st Floor'\n    }\n  }\n};\n\nconst branch = branchInfo[branchName]?.[langCode] || { \n  name: branchName, \n  phone: 'Ïó∞ÎùΩÏ≤ò ÏóÜÏùå', \n  address: 'Ï£ºÏÜå Ï†ïÎ≥¥ ÏóÜÏùå' \n};\n\n// üéØ Ïã§Ï†ú Íµ¨Í∏Ä ÎßµÏä§ ÎßÅÌÅ¨ (ÏàòÏ†ïÎê®!)\nconst googleMapsLink = branchName === 'Ekamai' \n  ? 'https://maps.app.goo.gl/xb1Q4SW4fYd56FoYA'  // ÏóêÍπåÎßàÏù¥ ÏßÄÏ†ê\n  : 'https://maps.app.goo.gl/PXyJGvjZcZu68RUL9';  // ÌîÑÎ°¨ÌêÅ ÏßÄÏ†ê\n\nreturn [{\n  json: {\n    bookingNumber: bookingNumber,\n    name: name,\n    email: email,\n    language: langCode,\n    branch: branchName,\n    branchAddress: branch.address,\n    branchPhone: branch.phone,\n    branchName: branch.name,\n    spaceType: spaceType,\n    roomNumber: roomNumber || '',\n    floor: floor || '',\n    guests: guests,\n    spaceInfo: spaceInfo,\n    \n    // üö® Ïù¥Î†áÍ≤å ÏàòÏ†ï! (Ïñ∏Ïñ¥Ïóê ÎßûÎäî Î¨∏ÏûêÏó¥Îßå Ï†ÑÎã¨)\n    bookingDate: dateFormatted[langCode],  // Í∞ùÏ≤¥Í∞Ä ÏïÑÎãå Î¨∏ÏûêÏó¥!\n    bookingTime: timeFormatted[langCode],  // Í∞ùÏ≤¥Í∞Ä ÏïÑÎãå Î¨∏ÏûêÏó¥!\n    \n    googleMapsLink: googleMapsLink\n  }\n}];"
      },
      "id": "48db2be1-02ac-4469-9384-c68785bfc090",
      "name": "Ïù¥Î©îÏùº Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        1008,
        1168
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$node['Ïï°ÏÖò ÌååÏã±'].json.action}}",
              "value2": "confirm"
            }
          ]
        }
      },
      "id": "6d30b7c0-18af-4ae5-ba02-51a8c1c0aeb2",
      "name": "Ïù¥Î©îÏùº Î∂ÑÍ∏∞",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        1216,
        1168
      ]
    },
    {
      "parameters": {
        "functionCode": "// ÌôïÏ†ï Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø ÏÉùÏÑ± (ÏôÑÏ†ÑÌïú Î≤ÑÏ†Ñ + index.html ÎîîÏûêÏù∏)\nconst data = items[0].json;\n\nconst templates = {\n  ko: {\n    subject: `[Î∂ÅÎßâÍ≥®] ÏòàÏïΩÏù¥ ÌôïÏ†ïÎêòÏóàÏäµÎãàÎã§ - ${data.bookingNumber}`,\n    body: `\n    <!DOCTYPE html>\n    <html lang=\"ko\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>ÏòàÏïΩ ÌôïÏ†ï</title>\n        <style>\n            * {\n                margin: 0;\n                padding: 0;\n                box-sizing: border-box;\n            }\n\n            body {\n                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n                background: linear-gradient(to bottom, #b0b0b0 0%, #9a9a9a 100%);\n                color: #2d2d2d;\n                line-height: 1.6;\n                min-height: 100vh;\n                padding: 20px;\n            }\n\n            .container {\n                max-width: 600px;\n                margin: 0 auto;\n                padding: 20px;\n            }\n\n            .header {\n                text-align: center;\n                margin-bottom: 30px;\n                padding: 30px 20px;\n                background: rgba(255, 255, 255, 0.5);\n                border-radius: 20px;\n                backdrop-filter: blur(10px);\n                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            .logo {\n                font-size: 2.5rem;\n                font-weight: 700;\n                color: #2d2d2d;\n                margin-bottom: 10px;\n                letter-spacing: 0.5px;\n                line-height: 1.4;\n            }\n\n            .subtitle {\n                font-size: 1.1rem;\n                color: #4a4a4a;\n                margin-bottom: 20px;\n            }\n\n            .form-container {\n                background: rgba(255, 255, 255, 0.5);\n                border-radius: 20px;\n                padding: 30px;\n                backdrop-filter: blur(10px);\n                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n                margin-bottom: 20px;\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            .form-section {\n                margin-bottom: 25px;\n            }\n\n            .section-title {\n                font-size: 1.2rem;\n                color: #2d2d2d;\n                margin-bottom: 15px;\n                padding-bottom: 8px;\n                border-bottom: 2px solid rgba(196, 196, 196, 0.6);\n                display: flex;\n                align-items: center;\n                font-weight: 600;\n            }\n\n            .section-number {\n    background: none;\n    color: #2d2d2d;\n    width: auto;\n    height: auto;\n    border-radius: 0;\n    display: inline;\n    margin-right: 10px;\n    font-size: 1.2rem;\n    font-weight: 600;\n}\n\n            .info-row {\n                display: flex;\n                margin: 15px 0;\n                padding: 12px 0;\n                border-bottom: 1px solid rgba(238, 238, 238, 0.7);\n            }\n\n            .info-label {\n                font-weight: 600;\n                color: #3a3a3a;\n                width: 120px;\n                flex-shrink: 0;\n            }\n\n            .info-value {\n                color: #2d2d2d;\n                flex: 1;\n            }\n\n            .success-message {\n                background: rgba(212, 237, 218, 0.8);\n                border: 2px solid rgba(40, 167, 69, 0.6);\n                color: #155724;\n                box-shadow: 0 4px 15px rgba(40, 167, 69, 0.2);\n                backdrop-filter: blur(10px);\n                padding: 20px;\n                border-radius: 15px;\n                margin: 20px 0;\n                text-align: center;\n                font-weight: 600;\n            }\n\n            .btn {\n                display: inline-block;\n                padding: 12px 25px;\n                background: rgba(74, 74, 74, 0.8);\n                color: white;\n                border: 2px solid rgba(74, 74, 74, 0.6);\n                border-radius: 15px;\n                font-size: 1rem;\n                font-weight: 600;\n                cursor: pointer;\n                transition: all 0.3s ease;\n                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n                text-decoration: none;\n                text-align: center;\n                margin: 10px 5px;\n                backdrop-filter: blur(10px);\n            }\n\n            .btn:hover {\n                transform: translateY(-2px);\n                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);\n                background: rgba(58, 58, 58, 0.9);\n            }\n\n            .notice-list {\n                color: #3a3a3a;\n                padding: 10px 0;\n            }\n\n            .notice-list ul {\n                list-style: none;\n                padding: 0;\n                margin: 15px 0;\n            }\n\n            .notice-list li {\n                padding: 8px 0;\n                border-left: 3px solid rgba(74, 74, 74, 0.6);\n                padding-left: 15px;\n                margin: 8px 0;\n                background: rgba(255, 255, 255, 0.3);\n                border-radius: 5px;\n                padding: 10px 15px;\n            }\n\n            .final-message {\n                text-align: center;\n                margin-top: 30px;\n                padding: 25px;\n                background: rgba(255, 255, 255, 0.4);\n                border-radius: 15px;\n                backdrop-filter: blur(10px);\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            @media (max-width: 768px) {\n                .container {\n                    padding: 10px;\n                }\n\n                .logo {\n                    font-size: 2rem;\n                }\n\n                .form-container {\n                    padding: 20px;\n                }\n\n                .info-row {\n                    flex-direction: column;\n                }\n\n                .info-label {\n                    width: auto;\n                    margin-bottom: 5px;\n                }\n            }\n        </style>\n    </head>\n    <body>\n        <div class=\"container\">\n            <div class=\"header\">\n                <div class=\"logo\">üçΩÔ∏è Î∂ÅÎßâÍ≥®</div>\n                <div class=\"subtitle\">ÏòàÏïΩÏù¥ ÌôïÏ†ïÎêòÏóàÏäµÎãàÎã§!</div>\n            </div>\n\n            <div class=\"form-container\">\n                <div class=\"success-message\">\n                    ‚úÖ ${data.name}ÎãòÏùò ÏòàÏïΩÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÌôïÏ†ïÎêòÏóàÏäµÎãàÎã§! üéâ\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">üìã</span>\n                        ÏòàÏïΩ Ï†ïÎ≥¥\n                    </h3>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">ÏòàÏïΩÎ≤àÌò∏:</div>\n                        <div class=\"info-value\"><strong>${data.bookingNumber}</strong></div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">ÎÇ†Ïßú:</div>\n                        <div class=\"info-value\">${data.bookingDate}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">ÏãúÍ∞Ñ:</div>\n                        <div class=\"info-value\">${data.bookingTime}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">ÏßÄÏ†ê:</div>\n                        <div class=\"info-value\">${data.branch}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Í≥µÍ∞Ñ:</div>\n                        <div class=\"info-value\">${data.spaceInfo}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Ïù∏Ïõê:</div>\n                        <div class=\"info-value\">${data.guests}Î™Ö</div>\n                    </div>\n                    ${data.specialRequest ? `\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">ÌäπÎ≥ÑÏöîÏ≤≠:</div>\n                        <div class=\"info-value\">${data.specialRequest}</div>\n                    </div>\n                    ` : ''}\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">üìç</span>\n                        Ïò§ÏãúÎäî Í∏∏\n                    </h3>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Ï£ºÏÜå:</div>\n                        <div class=\"info-value\">${data.branchAddress}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Ï†ÑÌôî:</div>\n                        <div class=\"info-value\">${data.branchPhone}</div>\n                    </div>\n                    <div style=\"text-align: center; margin-top: 20px;\">\n                        <a href=\"${data.googleMapsLink}\" class=\"btn\">üìç Í∏∏Ï∞æÍ∏∞</a>\n                    </div>\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">‚ö†Ô∏è</span>\n                        ÏòàÏïΩ ÏïàÎÇ¥\n                    </h3>\n                    <div class=\"notice-list\">\n                        <ul>\n                            <li>ÏòàÏïΩ Ï∑®ÏÜå/Î≥ÄÍ≤Ω: Ï†ÑÌôî ÎòêÎäî ÎùºÏù∏ÏúºÎ°ú Ïó∞ÎùΩÏ£ºÏÑ∏Ïöî</li>\n                            <li>Î£∏ ÏòàÏïΩ: ÌèâÍ∑† Ïù¥Ïö©ÏãúÍ∞Ñ 3-4ÏãúÍ∞Ñ</li>\n                            <li>ÏòÅÏóÖÏãúÍ∞Ñ: 11:00-15:00, 16:00-22:00</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"final-message\">\n                    <p><strong>ÎßõÏûàÎäî ÏãùÏÇ¨ Ï§ÄÎπÑÌïòÍ≥† Í∏∞Îã§Î¶¨Í≤†ÏäµÎãàÎã§!</strong></p>\n                    <p>Í∞êÏÇ¨Ìï©ÎãàÎã§. Î∂ÅÎßâÍ≥® ÎìúÎ¶º</p>\n                </div>\n            </div>\n        </div>\n    </body>\n    </html>\n    `\n  },\n  th: {\n    subject: `[Bookmakgol] ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß - ${data.bookingNumber}`,\n    body: `\n    <!DOCTYPE html>\n    <html lang=\"th\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</title>\n        <style>\n            * {\n                margin: 0;\n                padding: 0;\n                box-sizing: border-box;\n            }\n\n            body {\n                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n                background: linear-gradient(to bottom, #b0b0b0 0%, #9a9a9a 100%);\n                color: #2d2d2d;\n                line-height: 1.6;\n                min-height: 100vh;\n                padding: 20px;\n            }\n\n            .container {\n                max-width: 600px;\n                margin: 0 auto;\n                padding: 20px;\n            }\n\n            .header {\n                text-align: center;\n                margin-bottom: 30px;\n                padding: 30px 20px;\n                background: rgba(255, 255, 255, 0.5);\n                border-radius: 20px;\n                backdrop-filter: blur(10px);\n                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            .logo {\n                font-size: 2.5rem;\n                font-weight: 700;\n                color: #2d2d2d;\n                margin-bottom: 10px;\n                letter-spacing: 0.5px;\n                line-height: 1.4;\n            }\n\n            .subtitle {\n                font-size: 1.1rem;\n                color: #4a4a4a;\n                margin-bottom: 20px;\n            }\n\n            .form-container {\n                background: rgba(255, 255, 255, 0.5);\n                border-radius: 20px;\n                padding: 30px;\n                backdrop-filter: blur(10px);\n                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n                margin-bottom: 20px;\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            .form-section {\n                margin-bottom: 25px;\n            }\n\n            .section-title {\n                font-size: 1.2rem;\n                color: #2d2d2d;\n                margin-bottom: 15px;\n                padding-bottom: 8px;\n                border-bottom: 2px solid rgba(196, 196, 196, 0.6);\n                display: flex;\n                align-items: center;\n                font-weight: 600;\n            }\n\n           .section-number {\n    background: none;\n    color: #2d2d2d;\n    width: auto;\n    height: auto;\n    border-radius: 0;\n    display: inline;\n    margin-right: 10px;\n    font-size: 1.2rem;\n    font-weight: 600;\n}\n\n            .info-row {\n                display: flex;\n                margin: 15px 0;\n                padding: 12px 0;\n                border-bottom: 1px solid rgba(238, 238, 238, 0.7);\n            }\n\n            .info-label {\n                font-weight: 600;\n                color: #3a3a3a;\n                width: 120px;\n                flex-shrink: 0;\n            }\n\n            .info-value {\n                color: #2d2d2d;\n                flex: 1;\n            }\n\n            .success-message {\n                background: rgba(212, 237, 218, 0.8);\n                border: 2px solid rgba(40, 167, 69, 0.6);\n                color: #155724;\n                box-shadow: 0 4px 15px rgba(40, 167, 69, 0.2);\n                backdrop-filter: blur(10px);\n                padding: 20px;\n                border-radius: 15px;\n                margin: 20px 0;\n                text-align: center;\n                font-weight: 600;\n            }\n\n            .btn {\n                display: inline-block;\n                padding: 12px 25px;\n                background: rgba(74, 74, 74, 0.8);\n                color: white;\n                border: 2px solid rgba(74, 74, 74, 0.6);\n                border-radius: 15px;\n                font-size: 1rem;\n                font-weight: 600;\n                cursor: pointer;\n                transition: all 0.3s ease;\n                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n                text-decoration: none;\n                text-align: center;\n                margin: 10px 5px;\n                backdrop-filter: blur(10px);\n            }\n\n            .btn:hover {\n                transform: translateY(-2px);\n                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);\n                background: rgba(58, 58, 58, 0.9);\n            }\n\n            .notice-list {\n                color: #3a3a3a;\n                padding: 10px 0;\n            }\n\n            .notice-list ul {\n                list-style: none;\n                padding: 0;\n                margin: 15px 0;\n            }\n\n            .notice-list li {\n                padding: 8px 0;\n                border-left: 3px solid rgba(74, 74, 74, 0.6);\n                padding-left: 15px;\n                margin: 8px 0;\n                background: rgba(255, 255, 255, 0.3);\n                border-radius: 5px;\n                padding: 10px 15px;\n            }\n\n            .final-message {\n                text-align: center;\n                margin-top: 30px;\n                padding: 25px;\n                background: rgba(255, 255, 255, 0.4);\n                border-radius: 15px;\n                backdrop-filter: blur(10px);\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            @media (max-width: 768px) {\n                .container {\n                    padding: 10px;\n                }\n\n                .logo {\n                    font-size: 2rem;\n                }\n\n                .form-container {\n                    padding: 20px;\n                }\n\n                .info-row {\n                    flex-direction: column;\n                }\n\n                .info-label {\n                    width: auto;\n                    margin-bottom: 5px;\n                }\n            }\n        </style>\n    </head>\n    <body>\n        <div class=\"container\">\n            <div class=\"header\">\n                <div class=\"logo\">üçΩÔ∏è ‡∏ö‡∏∏‡∏Å‡∏°‡∏±‡∏Å‡∏Å‡∏•</div>\n                <div class=\"subtitle\">‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß!</div>\n            </div>\n\n            <div class=\"form-container\">\n                <div class=\"success-message\">\n                    ‚úÖ ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì${data.name} ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! üéâ\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">üìã</span>\n                        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á\n                    </h3>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á:</div>\n                        <div class=\"info-value\"><strong>${data.bookingNumber}</strong></div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</div>\n                        <div class=\"info-value\">${data.bookingDate}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡πÄ‡∏ß‡∏•‡∏≤:</div>\n                        <div class=\"info-value\">${data.bookingTime}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡∏™‡∏≤‡∏Ç‡∏≤:</div>\n                        <div class=\"info-value\">${data.branch}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà:</div>\n                        <div class=\"info-value\">${data.spaceInfo}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:</div>\n                        <div class=\"info-value\">${data.guests} ‡∏ó‡πà‡∏≤‡∏ô</div>\n                    </div>\n                    ${data.specialRequest ? `\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡πÄ‡∏®‡∏©:</div>\n                        <div class=\"info-value\">${data.specialRequest}</div>\n                    </div>\n                    ` : ''}\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">üìç</span>\n                        ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á\n                    </h3>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</div>\n                        <div class=\"info-value\">${data.branchAddress}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡πÇ‡∏ó‡∏£:</div>\n                        <div class=\"info-value\">${data.branchPhone}</div>\n                    </div>\n                    <div style=\"text-align: center; margin-top: 20px;\">\n                        <a href=\"${data.googleMapsLink}\" class=\"btn\">üìç ‡∏ô‡∏≥‡∏ó‡∏≤‡∏á</a>\n                    </div>\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">‚ö†Ô∏è</span>\n                        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á\n                    </h3>\n                    <div class=\"notice-list\">\n                        <ul>\n                            <li>‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å/‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á: ‡πÇ‡∏ó‡∏£‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏à‡πâ‡∏á‡∏ó‡∏≤‡∏á Line</li>\n                            <li>‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á: ‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 3-4 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</li>\n                            <li>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£: 11:00-15:00, 16:00-22:00</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"final-message\">\n                    <p><strong>‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏£‡πà‡∏≠‡∏¢‡∏£‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏∞‡∏Ñ‡∏∞/‡∏Ñ‡∏£‡∏±‡∏ö!</strong></p>\n                    <p>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏∞/‡∏Ñ‡∏£‡∏±‡∏ö Bookmakgol</p>\n                </div>\n            </div>\n        </div>\n    </body>\n    </html>\n    `\n  },\n  en: {\n    subject: `[Bookmakgol] Your Reservation is Confirmed - ${data.bookingNumber}`,\n    body: `\n    <!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>Reservation Confirmed</title>\n        <style>\n            * {\n                margin: 0;\n                padding: 0;\n                box-sizing: border-box;\n            }\n\n            body {\n                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n                background: linear-gradient(to bottom, #b0b0b0 0%, #9a9a9a 100%);\n                color: #2d2d2d;\n                line-height: 1.6;\n                min-height: 100vh;\n                padding: 20px;\n            }\n\n            .container {\n                max-width: 600px;\n                margin: 0 auto;\n                padding: 20px;\n            }\n\n            .header {\n                text-align: center;\n                margin-bottom: 30px;\n                padding: 30px 20px;\n                background: rgba(255, 255, 255, 0.5);\n                border-radius: 20px;\n                backdrop-filter: blur(10px);\n                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            .logo {\n                font-size: 2.5rem;\n                font-weight: 700;\n                color: #2d2d2d;\n                margin-bottom: 10px;\n                letter-spacing: 0.5px;\n                line-height: 1.4;\n            }\n\n            .subtitle {\n                font-size: 1.1rem;\n                color: #4a4a4a;\n                margin-bottom: 20px;\n            }\n\n            .form-container {\n                background: rgba(255, 255, 255, 0.5);\n                border-radius: 20px;\n                padding: 30px;\n                backdrop-filter: blur(10px);\n                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n                margin-bottom: 20px;\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            .form-section {\n                margin-bottom: 25px;\n            }\n\n            .section-title {\n                font-size: 1.2rem;\n                color: #2d2d2d;\n                margin-bottom: 15px;\n                padding-bottom: 8px;\n                border-bottom: 2px solid rgba(196, 196, 196, 0.6);\n                display: flex;\n                align-items: center;\n                font-weight: 600;\n            }\n\n        .section-number {\n    background: none;\n    color: #2d2d2d;\n    width: auto;\n    height: auto;\n    border-radius: 0;\n    display: inline;\n    margin-right: 10px;\n    font-size: 1.2rem;\n    font-weight: 600;\n}\n\n            .info-row {\n                display: flex;\n                margin: 15px 0;\n                padding: 12px 0;\n                border-bottom: 1px solid rgba(238, 238, 238, 0.7);\n            }\n\n            .info-label {\n                font-weight: 600;\n                color: #3a3a3a;\n                width: 120px;\n                flex-shrink: 0;\n            }\n\n            .info-value {\n                color: #2d2d2d;\n                flex: 1;\n            }\n\n            .success-message {\n                background: rgba(212, 237, 218, 0.8);\n                border: 2px solid rgba(40, 167, 69, 0.6);\n                color: #155724;\n                box-shadow: 0 4px 15px rgba(40, 167, 69, 0.2);\n                backdrop-filter: blur(10px);\n                padding: 20px;\n                border-radius: 15px;\n                margin: 20px 0;\n                text-align: center;\n                font-weight: 600;\n            }\n\n            .btn {\n                display: inline-block;\n                padding: 12px 25px;\n                background: rgba(74, 74, 74, 0.8);\n                color: white;\n                border: 2px solid rgba(74, 74, 74, 0.6);\n                border-radius: 15px;\n                font-size: 1rem;\n                font-weight: 600;\n                cursor: pointer;\n                transition: all 0.3s ease;\n                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n                text-decoration: none;\n                text-align: center;\n                margin: 10px 5px;\n                backdrop-filter: blur(10px);\n            }\n\n            .btn:hover {\n                transform: translateY(-2px);\n                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);\n                background: rgba(58, 58, 58, 0.9);\n            }\n\n            .notice-list {\n                color: #3a3a3a;\n                padding: 10px 0;\n            }\n\n            .notice-list ul {\n                list-style: none;\n                padding: 0;\n                margin: 15px 0;\n            }\n\n            .notice-list li {\n                padding: 8px 0;\n                border-left: 3px solid rgba(74, 74, 74, 0.6);\n                padding-left: 15px;\n                margin: 8px 0;\n                background: rgba(255, 255, 255, 0.3);\n                border-radius: 5px;\n                padding: 10px 15px;\n            }\n\n            .final-message {\n                text-align: center;\n                margin-top: 30px;\n                padding: 25px;\n                background: rgba(255, 255, 255, 0.4);\n                border-radius: 15px;\n                backdrop-filter: blur(10px);\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            @media (max-width: 768px) {\n                .container {\n                    padding: 10px;\n                }\n\n                .logo {\n                    font-size: 2rem;\n                }\n\n                .form-container {\n                    padding: 20px;\n                }\n\n                .info-row {\n                    flex-direction: column;\n                }\n\n                .info-label {\n                    width: auto;\n                    margin-bottom: 5px;\n                }\n            }\n        </style>\n    </head>\n    <body>\n        <div class=\"container\">\n            <div class=\"header\">\n                <div class=\"logo\">üçΩÔ∏è Bookmakgol</div>\n                <div class=\"subtitle\">Your Reservation is Confirmed!</div>\n            </div>\n\n            <div class=\"form-container\">\n                <div class=\"success-message\">\n                    ‚úÖ Dear ${data.name}, your reservation has been successfully confirmed! üéâ\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">üìã</span>\n                        Reservation Details\n                    </h3>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Booking No:</div>\n                        <div class=\"info-value\"><strong>${data.bookingNumber}</strong></div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Date:</div>\n                        <div class=\"info-value\">${data.bookingDate}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Time:</div>\n                        <div class=\"info-value\">${data.bookingTime}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Branch:</div>\n                        <div class=\"info-value\">${data.branch}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Space:</div>\n                        <div class=\"info-value\">${data.spaceInfo}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Guests:</div>\n                        <div class=\"info-value\">${data.guests} people</div>\n                    </div>\n                    ${data.specialRequest ? `\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Special Request:</div>\n                        <div class=\"info-value\">${data.specialRequest}</div>\n                    </div>\n                    ` : ''}\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">üìç</span>\n                        Location\n                    </h3>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Address:</div>\n                        <div class=\"info-value\">${data.branchAddress}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Phone:</div>\n                        <div class=\"info-value\">${data.branchPhone}</div>\n                    </div>\n                    <div style=\"text-align: center; margin-top: 20px;\">\n                        <a href=\"${data.googleMapsLink}\" class=\"btn\">üìç Directions</a>\n                    </div>\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">‚ö†Ô∏è</span>\n                        Important Information\n                    </h3>\n                    <div class=\"notice-list\">\n                        <ul>\n                            <li>Cancellation/Changes: Please call or contact via Line</li>\n                            <li>Room Reservation: Average usage time 3-4 hours</li>\n                            <li>Operating Hours: 11:00-15:00, 16:00-22:00</li>\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"final-message\">\n                    <p><strong>We're preparing delicious food and waiting for you!</strong></p>\n                    <p>Thank you, Bookmakgol</p>\n                </div>\n            </div>\n        </div>\n    </body>\n    </html>\n    `\n  }\n};\n\nconst template = templates[data.language] || templates.ko;\n\nreturn [{\n  json: {\n    ...data,\n    emailSubject: template.subject,\n    emailBody: template.body\n  }\n}];"
      },
      "id": "451a699d-2699-4c38-b828-34d49acf605d",
      "name": "ÌôïÏ†ï Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        1408,
        1072
      ]
    },
    {
      "parameters": {
        "functionCode": "// Ï∑®ÏÜå Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø (ÌôïÏ†ï Ïù¥Î©îÏùºÍ≥º ÎèôÏùºÌïú Íµ¨Ï°∞)\nconst data = items[0].json;\n\n// üö® Ïù¥ Î∂ÄÎ∂ÑÏùÑ Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî! (Line 3-4Ïóê Ï∂îÍ∞Ä)\nconst dateFormatted = data.dateFormatted || 'N/A';\nconst timeFormatted = data.timeFormatted || 'N/A';\n\n// Ïñ∏Ïñ¥ ÌôïÏù∏\nconst language = data.language || 'th';\n\n// ÏßÄÏ†êÎ™Ö Ï†ïÏùò\nconst branchInfo = {\n  'Ekamai': 'ÏóêÍπåÎßàÏù¥',\n  'Phrom Phong': 'ÌîÑÎ°¨ÌêÅ'\n};\n\nlet branchName;\nif (language === 'ko') {\n  branchName = branchInfo[data.branch] || data.branch;\n} else if (language === 'th') {\n  branchName = data.branch === 'Ekamai' ? '‡∏™‡∏≤‡∏Ç‡∏≤‡πÄ‡∏≠‡∏Å‡∏°‡∏±‡∏¢' : '‡∏™‡∏≤‡∏Ç‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏û‡∏á‡∏©‡πå';\n} else {\n  branchName = data.branch;\n}\n\n// ... ÎÇòÎ®∏ÏßÄ ÏΩîÎìú ...\n\nconst templates = {\n  ko: {\n    subject: `[Î∂ÅÎßâÍ≥®] ÏòàÏïΩÏù¥ Ï∑®ÏÜåÎêòÏóàÏäµÎãàÎã§ - ${data.bookingNumber}`,\n    body: `\n    <!DOCTYPE html>\n    <html lang=\"ko\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>ÏòàÏïΩ Ï∑®ÏÜå</title>\n        <style>\n            * {\n                margin: 0;\n                padding: 0;\n                box-sizing: border-box;\n            }\n\n            body {\n                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n                background: linear-gradient(to bottom, #b0b0b0 0%, #9a9a9a 100%);\n                color: #2d2d2d;\n                line-height: 1.6;\n                min-height: 100vh;\n                padding: 20px;\n            }\n\n            .container {\n                max-width: 600px;\n                margin: 0 auto;\n                padding: 20px;\n            }\n\n            .header {\n                text-align: center;\n                margin-bottom: 30px;\n                padding: 30px 20px;\n                background: rgba(255, 255, 255, 0.5);\n                border-radius: 20px;\n                backdrop-filter: blur(10px);\n                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            .logo {\n                font-size: 2.5rem;\n                font-weight: 700;\n                color: #2d2d2d;\n                margin-bottom: 10px;\n                letter-spacing: 0.5px;\n                line-height: 1.4;\n            }\n\n            .subtitle {\n                font-size: 1.1rem;\n                color: #4a4a4a;\n                margin-bottom: 20px;\n            }\n\n            .form-container {\n                background: rgba(255, 255, 255, 0.5);\n                border-radius: 20px;\n                padding: 30px;\n                backdrop-filter: blur(10px);\n                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n                margin-bottom: 20px;\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            .form-section {\n                margin-bottom: 25px;\n            }\n\n            .section-title {\n                font-size: 1.2rem;\n                color: #2d2d2d;\n                margin-bottom: 15px;\n                padding-bottom: 8px;\n                border-bottom: 2px solid rgba(196, 196, 196, 0.6);\n                display: flex;\n                align-items: center;\n                font-weight: 600;\n            }\n\n            .section-number {\n                background: none;\n                color: #2d2d2d;\n                width: auto;\n                height: auto;\n                border-radius: 0;\n                display: inline;\n                margin-right: 10px;\n                font-size: 1.2rem;\n                font-weight: 600;\n            }\n\n            .info-row {\n                display: flex;\n                margin: 15px 0;\n                padding: 12px 0;\n                border-bottom: 1px solid rgba(238, 238, 238, 0.7);\n            }\n\n            .info-label {\n                font-weight: 600;\n                color: #3a3a3a;\n                width: 120px;\n                flex-shrink: 0;\n            }\n\n            .info-value {\n                color: #2d2d2d;\n                flex: 1;\n            }\n\n            .cancel-message {\n                background: rgba(248, 215, 218, 0.8);\n                border: 2px solid rgba(220, 53, 69, 0.6);\n                color: #721c24;\n                box-shadow: 0 4px 15px rgba(220, 53, 69, 0.2);\n                backdrop-filter: blur(10px);\n                padding: 20px;\n                border-radius: 15px;\n                margin: 20px 0;\n                text-align: center;\n                font-weight: 600;\n            }\n\n            .btn {\n                display: inline-block;\n                padding: 12px 25px;\n                background: rgba(74, 74, 74, 0.8);\n                color: white;\n                border: 2px solid rgba(74, 74, 74, 0.6);\n                border-radius: 15px;\n                font-size: 1rem;\n                font-weight: 600;\n                cursor: pointer;\n                transition: all 0.3s ease;\n                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n                text-decoration: none;\n                text-align: center;\n                margin: 10px 5px;\n                backdrop-filter: blur(10px);\n            }\n\n            .btn:hover {\n                transform: translateY(-2px);\n                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);\n                background: rgba(58, 58, 58, 0.9);\n            }\n\n            .final-message {\n                text-align: center;\n                margin-top: 30px;\n                padding: 25px;\n                background: rgba(255, 255, 255, 0.4);\n                border-radius: 15px;\n                backdrop-filter: blur(10px);\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            @media (max-width: 768px) {\n                .container {\n                    padding: 10px;\n                }\n\n                .logo {\n                    font-size: 2rem;\n                }\n\n                .form-container {\n                    padding: 20px;\n                }\n\n                .info-row {\n                    flex-direction: column;\n                }\n\n                .info-label {\n                    width: auto;\n                    margin-bottom: 5px;\n                }\n            }\n        </style>\n    </head>\n    <body>\n        <div class=\"container\">\n            <div class=\"header\">\n                <div class=\"logo\">üçΩÔ∏è Î∂ÅÎßâÍ≥®</div>\n                <div class=\"subtitle\">ÏòàÏïΩÏù¥ Ï∑®ÏÜåÎêòÏóàÏäµÎãàÎã§</div>\n            </div>\n\n            <div class=\"form-container\">\n                <div class=\"cancel-message\">\n                    ‚ùå ${data.name}ÎãòÏùò ÏòàÏïΩÏù¥ Ï∑®ÏÜåÎêòÏóàÏäµÎãàÎã§\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">üìã</span>\n                        Ï∑®ÏÜåÎêú ÏòàÏïΩ Ï†ïÎ≥¥\n                    </h3>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">ÏòàÏïΩÎ≤àÌò∏:</div>\n                        <div class=\"info-value\"><strong>${data.bookingNumber}</strong></div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">ÎÇ†Ïßú:</div>\n                        <div class=\"info-value\">${data.bookingDate}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">ÏãúÍ∞Ñ:</div>\n                        <div class=\"info-value\">${data.bookingTime}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">ÏßÄÏ†ê:</div>\n                        <div class=\"info-value\">${data.branch}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Í≥µÍ∞Ñ:</div>\n                        <div class=\"info-value\">${data.spaceInfo}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Ïù∏Ïõê:</div>\n                        <div class=\"info-value\">${data.guests}Î™Ö</div>\n                    </div>\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">üìç</span>\n                        Î¨∏ÏùòÏ≤ò\n                    </h3>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Ï£ºÏÜå:</div>\n                        <div class=\"info-value\">${data.branchAddress}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Ï†ÑÌôî:</div>\n                        <div class=\"info-value\">${data.branchPhone}</div>\n                    </div>\n                    <div style=\"text-align: center; margin-top: 20px;\">\n                        <a href=\"${data.googleMapsLink}\" class=\"btn\">üìç Í∏∏Ï∞æÍ∏∞</a>\n                    </div>\n                </div>\n\n                <div class=\"final-message\">\n                    <p><strong>Îã§ÏùåÏóê Îçî Ï¢ãÏùÄ ÏÑúÎπÑÏä§Î°ú Ï∞æÏïÑÎµôÍ≤†ÏäµÎãàÎã§</strong></p>\n                    <p>Í∞êÏÇ¨Ìï©ÎãàÎã§. Î∂ÅÎßâÍ≥® ÎìúÎ¶º</p>\n                </div>\n            </div>\n        </div>\n    </body>\n    </html>\n    `\n  },\n  th: {\n    subject: `[Bookmakgol] ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß - ${data.bookingNumber}`,\n    body: `\n    <!DOCTYPE html>\n    <html lang=\"th\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</title>\n        <style>\n            * {\n                margin: 0;\n                padding: 0;\n                box-sizing: border-box;\n            }\n\n            body {\n                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n                background: linear-gradient(to bottom, #b0b0b0 0%, #9a9a9a 100%);\n                color: #2d2d2d;\n                line-height: 1.6;\n                min-height: 100vh;\n                padding: 20px;\n            }\n\n            .container {\n                max-width: 600px;\n                margin: 0 auto;\n                padding: 20px;\n            }\n\n            .header {\n                text-align: center;\n                margin-bottom: 30px;\n                padding: 30px 20px;\n                background: rgba(255, 255, 255, 0.5);\n                border-radius: 20px;\n                backdrop-filter: blur(10px);\n                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            .logo {\n                font-size: 2.5rem;\n                font-weight: 700;\n                color: #2d2d2d;\n                margin-bottom: 10px;\n                letter-spacing: 0.5px;\n                line-height: 1.4;\n            }\n\n            .subtitle {\n                font-size: 1.1rem;\n                color: #4a4a4a;\n                margin-bottom: 20px;\n            }\n\n            .form-container {\n                background: rgba(255, 255, 255, 0.5);\n                border-radius: 20px;\n                padding: 30px;\n                backdrop-filter: blur(10px);\n                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n                margin-bottom: 20px;\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            .form-section {\n                margin-bottom: 25px;\n            }\n\n            .section-title {\n                font-size: 1.2rem;\n                color: #2d2d2d;\n                margin-bottom: 15px;\n                padding-bottom: 8px;\n                border-bottom: 2px solid rgba(196, 196, 196, 0.6);\n                display: flex;\n                align-items: center;\n                font-weight: 600;\n            }\n\n            .section-number {\n                background: none;\n                color: #2d2d2d;\n                width: auto;\n                height: auto;\n                border-radius: 0;\n                display: inline;\n                margin-right: 10px;\n                font-size: 1.2rem;\n                font-weight: 600;\n            }\n\n            .info-row {\n                display: flex;\n                margin: 15px 0;\n                padding: 12px 0;\n                border-bottom: 1px solid rgba(238, 238, 238, 0.7);\n            }\n\n            .info-label {\n                font-weight: 600;\n                color: #3a3a3a;\n                width: 120px;\n                flex-shrink: 0;\n            }\n\n            .info-value {\n                color: #2d2d2d;\n                flex: 1;\n            }\n\n            .cancel-message {\n                background: rgba(248, 215, 218, 0.8);\n                border: 2px solid rgba(220, 53, 69, 0.6);\n                color: #721c24;\n                box-shadow: 0 4px 15px rgba(220, 53, 69, 0.2);\n                backdrop-filter: blur(10px);\n                padding: 20px;\n                border-radius: 15px;\n                margin: 20px 0;\n                text-align: center;\n                font-weight: 600;\n            }\n\n            .btn {\n                display: inline-block;\n                padding: 12px 25px;\n                background: rgba(74, 74, 74, 0.8);\n                color: white;\n                border: 2px solid rgba(74, 74, 74, 0.6);\n                border-radius: 15px;\n                font-size: 1rem;\n                font-weight: 600;\n                cursor: pointer;\n                transition: all 0.3s ease;\n                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n                text-decoration: none;\n                text-align: center;\n                margin: 10px 5px;\n                backdrop-filter: blur(10px);\n            }\n\n            .btn:hover {\n                transform: translateY(-2px);\n                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);\n                background: rgba(58, 58, 58, 0.9);\n            }\n\n            .final-message {\n                text-align: center;\n                margin-top: 30px;\n                padding: 25px;\n                background: rgba(255, 255, 255, 0.4);\n                border-radius: 15px;\n                backdrop-filter: blur(10px);\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            @media (max-width: 768px) {\n                .container {\n                    padding: 10px;\n                }\n\n                .logo {\n                    font-size: 2rem;\n                }\n\n                .form-container {\n                    padding: 20px;\n                }\n\n                .info-row {\n                    flex-direction: column;\n                }\n\n                .info-label {\n                    width: auto;\n                    margin-bottom: 5px;\n                }\n            }\n        </style>\n    </head>\n    <body>\n        <div class=\"container\">\n            <div class=\"header\">\n                <div class=\"logo\">üçΩÔ∏è ‡∏ö‡∏∏‡∏Å‡∏°‡∏±‡∏Å‡∏Å‡∏•</div>\n                <div class=\"subtitle\">‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß</div>\n            </div>\n\n            <div class=\"form-container\">\n                <div class=\"cancel-message\">\n                    ‚ùå ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì${data.name} ‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">üìã</span>\n                        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å\n                    </h3>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á:</div>\n                        <div class=\"info-value\"><strong>${data.bookingNumber}</strong></div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</div>\n                        <div class=\"info-value\">${data.bookingDate}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡πÄ‡∏ß‡∏•‡∏≤:</div>\n                        <div class=\"info-value\">${data.bookingTime}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡∏™‡∏≤‡∏Ç‡∏≤:</div>\n                        <div class=\"info-value\">${data.branch}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà:</div>\n                        <div class=\"info-value\">${data.spaceInfo}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:</div>\n                        <div class=\"info-value\">${data.guests} ‡∏ó‡πà‡∏≤‡∏ô</div>\n                    </div>\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">üìç</span>\n                        ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°\n                    </h3>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</div>\n                        <div class=\"info-value\">${data.branchAddress}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">‡πÇ‡∏ó‡∏£:</div>\n                        <div class=\"info-value\">${data.branchPhone}</div>\n                    </div>\n                    <div style=\"text-align: center; margin-top: 20px;\">\n                        <a href=\"${data.googleMapsLink}\" class=\"btn\">üìç ‡∏ô‡∏≥‡∏ó‡∏≤‡∏á</a>\n                    </div>\n                </div>\n\n                <div class=\"final-message\">\n                    <p><strong>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à</strong></p>\n                    <p>‡∏´‡∏ß‡∏±‡∏á‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ô‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ï‡πà‡∏≠‡πÑ‡∏õ Bookmakgol</p>\n                </div>\n            </div>\n        </div>\n    </body>\n    </html>\n    `\n  },\n  en: {\n    subject: `[Bookmakgol] Your reservation has been cancelled - ${data.bookingNumber}`,\n    body: `\n    <!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>Reservation Cancelled</title>\n        <style>\n            * {\n                margin: 0;\n                padding: 0;\n                box-sizing: border-box;\n            }\n\n            body {\n                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n                background: linear-gradient(to bottom, #b0b0b0 0%, #9a9a9a 100%);\n                color: #2d2d2d;\n                line-height: 1.6;\n                min-height: 100vh;\n                padding: 20px;\n            }\n\n            .container {\n                max-width: 600px;\n                margin: 0 auto;\n                padding: 20px;\n            }\n\n            .header {\n                text-align: center;\n                margin-bottom: 30px;\n                padding: 30px 20px;\n                background: rgba(255, 255, 255, 0.5);\n                border-radius: 20px;\n                backdrop-filter: blur(10px);\n                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            .logo {\n                font-size: 2.5rem;\n                font-weight: 700;\n                color: #2d2d2d;\n                margin-bottom: 10px;\n                letter-spacing: 0.5px;\n                line-height: 1.4;\n            }\n\n            .subtitle {\n                font-size: 1.1rem;\n                color: #4a4a4a;\n                margin-bottom: 20px;\n            }\n\n            .form-container {\n                background: rgba(255, 255, 255, 0.5);\n                border-radius: 20px;\n                padding: 30px;\n                backdrop-filter: blur(10px);\n                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n                margin-bottom: 20px;\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            .form-section {\n                margin-bottom: 25px;\n            }\n\n            .section-title {\n                font-size: 1.2rem;\n                color: #2d2d2d;\n                margin-bottom: 15px;\n                padding-bottom: 8px;\n                border-bottom: 2px solid rgba(196, 196, 196, 0.6);\n                display: flex;\n                align-items: center;\n                font-weight: 600;\n            }\n\n            .section-number {\n                background: none;\n                color: #2d2d2d;\n                width: auto;\n                height: auto;\n                border-radius: 0;\n                display: inline;\n                margin-right: 10px;\n                font-size: 1.2rem;\n                font-weight: 600;\n            }\n\n            .info-row {\n                display: flex;\n                margin: 15px 0;\n                padding: 12px 0;\n                border-bottom: 1px solid rgba(238, 238, 238, 0.7);\n            }\n\n            .info-label {\n                font-weight: 600;\n                color: #3a3a3a;\n                width: 120px;\n                flex-shrink: 0;\n            }\n\n            .info-value {\n                color: #2d2d2d;\n                flex: 1;\n            }\n\n            .cancel-message {\n                background: rgba(248, 215, 218, 0.8);\n                border: 2px solid rgba(220, 53, 69, 0.6);\n                color: #721c24;\n                box-shadow: 0 4px 15px rgba(220, 53, 69, 0.2);\n                backdrop-filter: blur(10px);\n                padding: 20px;\n                border-radius: 15px;\n                margin: 20px 0;\n                text-align: center;\n                font-weight: 600;\n            }\n\n            .btn {\n                display: inline-block;\n                padding: 12px 25px;\n                background: rgba(74, 74, 74, 0.8);\n                color: white;\n                border: 2px solid rgba(74, 74, 74, 0.6);\n                border-radius: 15px;\n                font-size: 1rem;\n                font-weight: 600;\n                cursor: pointer;\n                transition: all 0.3s ease;\n                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n                text-decoration: none;\n                text-align: center;\n                margin: 10px 5px;\n                backdrop-filter: blur(10px);\n            }\n\n            .btn:hover {\n                transform: translateY(-2px);\n                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);\n                background: rgba(58, 58, 58, 0.9);\n            }\n\n            .final-message {\n                text-align: center;\n                margin-top: 30px;\n                padding: 25px;\n                background: rgba(255, 255, 255, 0.4);\n                border-radius: 15px;\n                backdrop-filter: blur(10px);\n                border: 1px solid rgba(255, 255, 255, 0.3);\n            }\n\n            @media (max-width: 768px) {\n                .container {\n                    padding: 10px;\n                }\n\n                .logo {\n                    font-size: 2rem;\n                }\n\n                .form-container {\n                    padding: 20px;\n                }\n\n                .info-row {\n                    flex-direction: column;\n                }\n\n                .info-label {\n                    width: auto;\n                    margin-bottom: 5px;\n                }\n            }\n        </style>\n    </head>\n    <body>\n        <div class=\"container\">\n            <div class=\"header\">\n                <div class=\"logo\">üçΩÔ∏è Bookmakgol</div>\n                <div class=\"subtitle\">Your Reservation Has Been Cancelled</div>\n            </div>\n\n            <div class=\"form-container\">\n                <div class=\"cancel-message\">\n                    ‚ùå Dear ${data.name}, your reservation has been cancelled\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">üìã</span>\n                        Cancelled Reservation Details\n                    </h3>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Booking No:</div>\n                        <div class=\"info-value\"><strong>${data.bookingNumber}</strong></div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Date:</div>\n                        <div class=\"info-value\">${data.bookingDate}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Time:</div>\n                        <div class=\"info-value\">${data.bookingTime}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Branch:</div>\n                        <div class=\"info-value\">${data.branch}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Space:</div>\n                        <div class=\"info-value\">${data.spaceInfo}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Guests:</div>\n                        <div class=\"info-value\">${data.guests} people</div>\n                    </div>\n                </div>\n\n                <div class=\"form-section\">\n                    <h3 class=\"section-title\">\n                        <span class=\"section-number\">üìç</span>\n                        Contact Information\n                    </h3>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Address:</div>\n                        <div class=\"info-value\">${data.branchAddress}</div>\n                    </div>\n                    <div class=\"info-row\">\n                        <div class=\"info-label\">Phone:</div>\n                        <div class=\"info-value\">${data.branchPhone}</div>\n                    </div>\n                    <div style=\"text-align: center; margin-top: 20px;\">\n                        <a href=\"${data.googleMapsLink}\" class=\"btn\">üìç Directions</a>\n                    </div>\n                </div>\n\n                <div class=\"final-message\">\n                    <p><strong>Thank you for your interest</strong></p>\n                    <p>We hope to serve you again in the future. Bookmakgol</p>\n                </div>\n            </div>\n        </div>\n    </body>\n    </html>\n    `\n  }\n};\n\nconst template = templates[data.language] || templates.ko;\n\nreturn [{\n  json: {\n    emailSubject: template.subject,\n    emailBody: template.body,\n    email: data.email  // üö® Ïù¥ Ï§ÑÏùÑ Ï∂îÍ∞Ä!\n  }\n}];"
      },
      "id": "cc2fb639-750b-4526-a39e-0fda45a17f00",
      "name": "Ï∑®ÏÜå Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        1408,
        1280
      ]
    },
    {
      "parameters": {
        "resource": "message",
        "subject": "={{$json.emailSubject}}",
        "includeHtml": true,
        "htmlMessage": "={{$json.emailBody}}",
        "message": "=",
        "toList": [
          "={{$json.email}}"
        ],
        "additionalFields": {}
      },
      "id": "7875cbc9-c123-46fa-b2c9-ca6f648f7594",
      "name": "Í≥†Í∞ù Ïù¥Î©îÏùº Î∞úÏÜ°",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 1,
      "position": [
        1616,
        1168
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "unDkKIDCn6d2hi5Z",
          "name": "Bookmagol Gmail account"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"status\": \"error\",\n  \"message\": \"{{$json.message}}\"\n}",
        "options": {}
      },
      "id": "e68ee750-1b34-4169-af6d-52b92bac43b1",
      "name": "Ïò§Î•ò ÏùëÎãµ1",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        0,
        976
      ]
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{$json.length}}",
              "operation": "equal"
            }
          ]
        }
      },
      "id": "ee5aee2b-35ca-43b4-8022-32a4b18d066a",
      "name": "ÏòàÏïΩ Ï°¥Ïû¨ ÌôïÏù∏1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        192,
        1168
      ]
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html lang=\"th\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô | Bookmakgol Admin</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n            background: linear-gradient(to bottom, #b0b0b0 0%, #9a9a9a 100%);\n            color: #2d2d2d;\n            line-height: 1.6;\n            min-height: 100vh;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            padding: 20px;\n        }\n\n        .container {\n            max-width: 500px;\n            width: 100%;\n            text-align: center;\n            background: rgba(255, 255, 255, 0.5);\n            border-radius: 20px;\n            padding: 40px 30px;\n            backdrop-filter: blur(10px);\n            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n            border: 1px solid rgba(255, 255, 255, 0.3);\n        }\n\n        .checkmark {\n            font-size: 80px;\n            margin-bottom: 20px;\n            animation: bounce 1s ease-in-out;\n            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));\n        }\n\n        .checkmark.confirm {\n            color: #28a745;\n        }\n\n        .checkmark.cancel {\n            color: #dc3545;\n        }\n\n        @keyframes bounce {\n            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }\n            40% { transform: translateY(-10px); }\n            60% { transform: translateY(-5px); }\n        }\n\n        .logo {\n            font-size: 1.8rem;\n            font-weight: 700;\n            color: #2d2d2d;\n            margin-bottom: 10px;\n            letter-spacing: 0.5px;\n        }\n\n        h1 {\n            font-size: 1.8rem;\n            margin-bottom: 15px;\n            font-weight: 600;\n            color: #2d2d2d;\n        }\n\n        h1.confirm {\n            color: #28a745;\n        }\n\n        h1.cancel {\n            color: #dc3545;\n        }\n\n        .message {\n            font-size: 1rem;\n            opacity: 0.8;\n            margin-bottom: 30px;\n            line-height: 1.5;\n            color: #3a3a3a;\n        }\n\n        .status {\n            background: rgba(255, 255, 255, 0.3);\n            border-radius: 15px;\n            padding: 15px 25px;\n            margin: 20px 0;\n            backdrop-filter: blur(5px);\n            border: 1px solid rgba(255, 255, 255, 0.2);\n        }\n\n        .status.confirm {\n            background: rgba(40, 167, 69, 0.1);\n            border-color: rgba(40, 167, 69, 0.3);\n        }\n\n        .status.cancel {\n            background: rgba(220, 53, 69, 0.1);\n            border-color: rgba(220, 53, 69, 0.3);\n        }\n\n        .close-btn {\n            background: #4a4a4a;\n            border: 2px solid #4a4a4a;\n            color: white;\n            padding: 12px 30px;\n            border-radius: 10px;\n            font-size: 1rem;\n            font-weight: 600;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            font-family: inherit;\n            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n        }\n\n        .close-btn:hover {\n            transform: translateY(-2px);\n            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);\n            background: #3a3a3a;\n        }\n\n        .admin-badge {\n            background: rgba(74, 74, 74, 0.1);\n            border: 1px solid rgba(74, 74, 74, 0.2);\n            border-radius: 10px;\n            padding: 8px 16px;\n            font-size: 0.85rem;\n            color: #4a4a4a;\n            margin-top: 20px;\n            display: inline-block;\n            backdrop-filter: blur(5px);\n        }\n\n        .auto-close {\n            font-size: 0.9rem;\n            color: #666;\n            margin-top: 15px;\n            font-style: italic;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"checkmark {{$node['Ïï°ÏÖò ÌååÏã±'].json.action === 'confirm' ? 'confirm' : 'cancel'}}\">\n            {{$node['Ïï°ÏÖò ÌååÏã±'].json.action === 'confirm' ? '‚úÖ' : '‚ùå'}}\n        </div>\n        \n        <div class=\"logo\">üçΩÔ∏è Bookmakgol</div>\n        \n        <h1 class=\"{{$node['Ïï°ÏÖò ÌååÏã±'].json.action === 'confirm' ? 'confirm' : 'cancel'}}\">\n            {{$node['Ïï°ÏÖò ÌååÏã±'].json.action === 'confirm' ? '‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô!' : '‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß!'}}\n        </h1>\n        \n        <div class=\"message\">\n            {{$node['Ïï°ÏÖò ÌååÏã±'].json.action === 'confirm' ? \n                '‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß<br>‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß' : \n                '‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß<br>‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏à‡πâ‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß'}}\n        </div>\n        \n        <div class=\"status {{$node['Ïï°ÏÖò ÌååÏã±'].json.action === 'confirm' ? 'confirm' : 'cancel'}}\">\n            <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> {{$node['Ïï°ÏÖò ÌååÏã±'].json.action === 'confirm' ? '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'}}<br>\n            <strong>‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:</strong> ‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏•‡πâ‡∏ß<br>\n            <strong>‡πÄ‡∏ß‡∏•‡∏≤:</strong> {{new Date().toLocaleString('th-TH', {timeZone: 'Asia/Bangkok'})}}\n        </div>\n        \n        <button class=\"close-btn\" onclick=\"window.close()\">‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á</button>\n        \n        <div class=\"admin-badge\">Admin System</div>\n        \n        <div class=\"auto-close\">‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏∞‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏ô 2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ...</div>\n    </div>\n    \n    <script>\n        setTimeout(() => {\n            window.close();\n        }, 2000);\n    </script>\n</body>\n</html>",
        "options": {}
      },
      "id": "f7b7194f-aeee-4569-9000-d57f66af4050",
      "name": "ÏÑ±Í≥µ ÏùëÎãµ1",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        1808,
        1168
      ]
    },
    {
      "parameters": {
        "path": "check-availability",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "fa8c3c18-5e6d-49db-b850-c125e6b3392c",
      "name": "Webhook - Check Availability",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [
        -608,
        1632
      ],
      "webhookId": "check-availability"
    },
    {
      "parameters": {
        "functionCode": "// üéØ ÏûÖÎ†•Í∞í ÌååÏã± Î∞è Í≤ÄÏ¶ù\nconst queryParams = $input.item.json.query;\n\nconst date = queryParams.date;\nconst branch = queryParams.branch;\nconst room = queryParams.room;\n\n// Í≤ÄÏ¶ù\nif (!date || !branch || !room) {\n  return {\n    json: {\n      error: 'Missing required parameters: date, branch, room',\n      blockedSlots: []\n    }\n  };\n}\n\n// RoomÏù¥ ÏïÑÎãàÎ©¥ Îπà Î∞∞Ïó¥ Î∞òÌôò (TableÏùÄ Ï§ëÎ≥µ Ï≤¥ÌÅ¨ Ïïà Ìï®)\nif (!room.includes('Room')) {\n  return {\n    json: {\n      date,\n      branch,\n      room,\n      bookedTimes: [],\n      blockedSlots: [],\n      message: 'Table reservations do not require time blocking'\n    }\n  };\n}\n\n// Notion ÏøºÎ¶¨Ïö© Îç∞Ïù¥ÌÑ∞ Î∞òÌôò\nreturn {\n  json: {\n    date,\n    branch,\n    room,\n    // NotionÏóêÏÑú Í≤ÄÏÉâÌï† ÎÇ†Ïßú Î≤îÏúÑ (Ìï¥Îãπ ÎÇ†Ïßú Ï†ÑÏ≤¥)\n    dateStart: `${date}T00:00:00+07:00`,\n    dateEnd: `${date}T23:59:59+07:00`\n  }\n};"
      },
      "id": "e5ece04b-ac92-4c94-9b91-14ed2a46459b",
      "name": "Parse Query Parameters",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        -400,
        1632
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "284a2fb1-c15d-81a1-9d93-d4f47300f2e3",
          "mode": "list",
          "cachedResultName": "Bookmakgol Reservation Management",
          "cachedResultUrl": "https://www.notion.so/284a2fb1c15d81a19d93d4f47300f2e3"
        },
        "returnAll": true,
        "filterType": "manual",
        "matchType": "allFilters",
        "filters": {
          "conditions": [
            {
              "key": "Reservation DateTime|date",
              "condition": "on_or_after",
              "date": "={{ $json.dateStart }}"
            },
            {
              "key": "Reservation DateTime|date",
              "condition": "on_or_before",
              "date": "={{ $json.dateEnd }}"
            },
            {
              "key": "Branch|select",
              "condition": "equals",
              "selectValue": "={{ $json.branch }}"
            },
            {
              "key": "Room Number|select",
              "condition": "equals",
              "selectValue": "={{ $json.room }}"
            },
            {
              "key": "Status|select",
              "condition": "does_not_equal",
              "selectValue": "=Cancelled"
            }
          ]
        },
        "options": {}
      },
      "id": "97a40e0c-d869-4777-a9d7-63877c7527ae",
      "name": "Query Notion - Existing Reservations",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2,
      "position": [
        -208,
        1632
      ],
      "credentials": {
        "notionApi": {
          "id": "AU29qZb94H2pm2jL",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "functionCode": "// üéØ ÏòàÏïΩÎêú ÏãúÍ∞ÑÏùÑ 3ÏãúÍ∞Ñ Î∏îÎ°ùÏúºÎ°ú Í≥ÑÏÇ∞\nconst items = $input.all();\nconst bookedTimes = [];\nconst blockedSlots = new Set();\n\n// ÏòàÏïΩÎêú ÏãúÍ∞Ñ Ï∂îÏ∂ú\nfor (const item of items) {\n  const properties = item.json.properties;\n  \n  // Time ÌïÑÎìúÏóêÏÑú ÏãúÍ∞Ñ Ï∂îÏ∂ú (Ïòà: \"18:00\")\n  const timeValue = properties.Time?.rich_text?.[0]?.plain_text || \n                    properties.Time?.title?.[0]?.plain_text ||\n                    properties['Reservation DateTime']?.date?.start?.split('T')[1]?.substring(0, 5);\n  \n  if (timeValue) {\n    bookedTimes.push(timeValue);\n    \n    // 3ÏãúÍ∞Ñ Î∏îÎ°ù Í≥ÑÏÇ∞ (ÏãúÏûë 30Î∂Ñ Ï†ÑÎ∂ÄÌÑ∞ Ï¢ÖÎ£å 30Î∂Ñ ÌõÑÍπåÏßÄ)\n    const [hour, minute] = timeValue.split(':').map(Number);\n    const startMinutes = hour * 60 + minute;\n    \n    // ÏãúÏûë 30Î∂Ñ Ï†ÑÎ∂ÄÌÑ∞ Ï¢ÖÎ£å 30Î∂Ñ ÌõÑÍπåÏßÄ Î∏îÎ°ù (Ï¥ù 4ÏãúÍ∞Ñ)\n    // Ïòà: 18:00 ÏòàÏïΩ ‚Üí 17:30, 18:00, 18:30, 19:00, 19:30, 20:00, 20:30, 21:00 Î∏îÎ°ù\n    for (let offset = -30; offset <= 210; offset += 30) {\n      const totalMinutes = startMinutes + offset;\n      const blockHour = Math.floor(totalMinutes / 60);\n      const blockMinute = totalMinutes % 60;\n      \n      if (blockHour >= 0 && blockHour < 24) {\n        const timeSlot = `${blockHour.toString().padStart(2, '0')}:${blockMinute.toString().padStart(2, '0')}`;\n        blockedSlots.add(timeSlot);\n      }\n    }\n  }\n}\n\n// SetÏùÑ ArrayÎ°ú Î≥ÄÌôòÌïòÍ≥† Ï†ïÎ†¨\nconst blockedArray = Array.from(blockedSlots).sort();\n\nreturn {\n  json: {\n    date: $('Parse Query Parameters').item.json.date,\n    branch: $('Parse Query Parameters').item.json.branch,\n    room: $('Parse Query Parameters').item.json.room,\n    bookedTimes: bookedTimes.sort(),\n    blockedSlots: blockedArray,\n    totalReservations: bookedTimes.length,\n    totalBlockedSlots: blockedArray.length\n  }\n};"
      },
      "id": "e0e4b515-b89f-4371-8a3c-8840c5a4017c",
      "name": "Calculate Blocked Time Slots",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        0,
        1632
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseHeaders": {
            "entries": [
              {
                "name": "Content-Type",
                "value": "application/json"
              },
              {
                "name": "Access-Control-Allow-Origin",
                "value": "*"
              },
              {
                "name": "Access-Control-Allow-Methods",
                "value": "GET, OPTIONS"
              }
            ]
          }
        }
      },
      "id": "34002384-61c2-45b2-ac3a-8925d4bdbe55",
      "name": "Respond to Webhook",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        192,
        1632
      ]
    }
  ],
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù": {
      "main": [
        [
          {
            "node": "Í≤ÄÏ¶ù Ïò§Î•ò Ï≤¥ÌÅ¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Í≤ÄÏ¶ù Ïò§Î•ò Ï≤¥ÌÅ¨": {
      "main": [
        [
          {
            "node": "Ïò§Î•ò ÏùëÎãµ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Ï§ëÎ≥µ ÏòàÏïΩ Ï≤¥ÌÅ¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ï§ëÎ≥µ ÏòàÏïΩ Ï≤¥ÌÅ¨": {
      "main": [
        [
          {
            "node": "Ï§ëÎ≥µ Í≤ÄÏÇ¨ Î°úÏßÅ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ï§ëÎ≥µ Í≤ÄÏÇ¨ Î°úÏßÅ": {
      "main": [
        [
          {
            "node": "Ï§ëÎ≥µ ÏòàÏïΩ ÌôïÏù∏",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ï§ëÎ≥µ ÏòàÏïΩ ÌôïÏù∏": {
      "main": [
        [
          {
            "node": "Ï§ëÎ≥µ Ïò§Î•ò ÏùëÎãµ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ÏòàÏïΩÎ≤àÌò∏ ÏÉùÏÑ±": {
      "main": [
        [
          {
            "node": "NotionÏóê Ï†ÄÏû•",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "NotionÏóê Ï†ÄÏû•": {
      "main": [
        [
          {
            "node": "Í¥ÄÎ¶¨Ïûê Ïù¥Î©îÏùº ÏÉùÏÑ±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Í¥ÄÎ¶¨Ïûê Ïù¥Î©îÏùº ÏÉùÏÑ±": {
      "main": [
        [
          {
            "node": "Í¥ÄÎ¶¨Ïûê Ïù¥Î©îÏùº Î∞úÏÜ°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Í¥ÄÎ¶¨Ïûê Ïù¥Î©îÏùº Î∞úÏÜ°": {
      "main": [
        [
          {
            "node": "ÏÑ±Í≥µ ÏùëÎãµ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ïä§ÏºÄÏ§Ñ Ìä∏Î¶¨Í±∞": {
      "main": [
        [
          {
            "node": "ÎÇ¥Ïùº ÎÇ†Ïßú Í≥ÑÏÇ∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ÎÇ¥Ïùº ÎÇ†Ïßú Í≥ÑÏÇ∞": {
      "main": [
        [
          {
            "node": "ÎÇ¥Ïùº ÏòàÏïΩ Ï°∞Ìöå",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ÎÇ¥Ïùº ÏòàÏïΩ Ï°∞Ìöå": {
      "main": [
        [
          {
            "node": "ÏòàÏïΩ Ï°¥Ïû¨ ÌôïÏù∏",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ÏòàÏïΩ Ï°¥Ïû¨ ÌôïÏù∏": {
      "main": [
        [],
        [
          {
            "node": "Î¶¨ÎßàÏù∏Îçî Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Î¶¨ÎßàÏù∏Îçî Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ": {
      "main": [
        [
          {
            "node": "Î¶¨ÎßàÏù∏Îçî ÌÖúÌîåÎ¶ø ÏÉùÏÑ±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Î¶¨ÎßàÏù∏Îçî ÌÖúÌîåÎ¶ø ÏÉùÏÑ±": {
      "main": [
        [
          {
            "node": "Î¶¨ÎßàÏù∏Îçî Ïù¥Î©îÏùº Î∞úÏÜ°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Î¶¨ÎßàÏù∏Îçî Ïù¥Î©îÏùº Î∞úÏÜ°": {
      "main": [
        [
          {
            "node": "Î¶¨ÎßàÏù∏Îçî Î∞úÏÜ° ÌëúÏãú",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Î¶¨ÎßàÏù∏Îçî Î∞úÏÜ° ÌëúÏãú": {
      "main": [
        [
          {
            "node": "Ï≤òÎ¶¨ ÏôÑÎ£å Î°úÍ∑∏",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Í¥ÄÎ¶¨Ïûê Î≤ÑÌäº Webhook": {
      "main": [
        [
          {
            "node": "Ïï°ÏÖò ÌååÏã±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ïï°ÏÖò ÌååÏã±": {
      "main": [
        [
          {
            "node": "Ïò§Î•ò Ï≤¥ÌÅ¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ïò§Î•ò Ï≤¥ÌÅ¨": {
      "main": [
        [
          {
            "node": "Ïò§Î•ò ÏùëÎãµ1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ÏòàÏïΩ Ï°∞Ìöå",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ÏòàÏïΩ Ï°∞Ìöå": {
      "main": [
        [
          {
            "node": "ÏòàÏïΩ Ï°¥Ïû¨ ÌôïÏù∏1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ïï°ÏÖò Î∂ÑÍ∏∞": {
      "main": [
        [
          {
            "node": "ÏòàÏïΩ ÌôïÏ†ï ÏóÖÎç∞Ïù¥Ìä∏",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ÏòàÏïΩ Ï∑®ÏÜå ÏóÖÎç∞Ïù¥Ìä∏",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ÏòàÏïΩ ÌôïÏ†ï ÏóÖÎç∞Ïù¥Ìä∏": {
      "main": [
        [
          {
            "node": "Ïù¥Î©îÏùº Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ÏòàÏïΩ Ï∑®ÏÜå ÏóÖÎç∞Ïù¥Ìä∏": {
      "main": [
        [
          {
            "node": "Ïù¥Î©îÏùº Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ïù¥Î©îÏùº Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ": {
      "main": [
        [
          {
            "node": "Ïù¥Î©îÏùº Î∂ÑÍ∏∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ïù¥Î©îÏùº Î∂ÑÍ∏∞": {
      "main": [
        [
          {
            "node": "ÌôïÏ†ï Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Ï∑®ÏÜå Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ÌôïÏ†ï Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø": {
      "main": [
        [
          {
            "node": "Í≥†Í∞ù Ïù¥Î©îÏùº Î∞úÏÜ°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ï∑®ÏÜå Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø": {
      "main": [
        [
          {
            "node": "Í≥†Í∞ù Ïù¥Î©îÏùº Î∞úÏÜ°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Í≥†Í∞ù Ïù¥Î©îÏùº Î∞úÏÜ°": {
      "main": [
        [
          {
            "node": "ÏÑ±Í≥µ ÏùëÎãµ1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ÏòàÏïΩ Ï°¥Ïû¨ ÌôïÏù∏1": {
      "main": [
        [
          {
            "node": "ÏòàÏïΩ ÏóÜÏùå ÏùëÎãµ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Ïï°ÏÖò Î∂ÑÍ∏∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook - Check Availability": {
      "main": [
        [
          {
            "node": "Parse Query Parameters",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Query Parameters": {
      "main": [
        [
          {
            "node": "Query Notion - Existing Reservations",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Query Notion - Existing Reservations": {
      "main": [
        [
          {
            "node": "Calculate Blocked Time Slots",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Calculate Blocked Time Slots": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": {
    "node:Ïä§ÏºÄÏ§Ñ Ìä∏Î¶¨Í±∞": {
      "recurrenceRules": []
    }
  },
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "ab58e734-0658-4aa5-92b9-b65bf0eaf300",
  "triggerCount": 4,
  "shared": [
    {
      "updatedAt": "2025-11-03T08:26:19.724Z",
      "createdAt": "2025-11-03T08:26:19.724Z",
      "role": "workflow:owner",
      "workflowId": "dDiWSm8cQZaADkIs",
      "projectId": "VhyLtdFs59nOMmgs"
    }
  ],
  "tags": [
    {
      "updatedAt": "2025-11-03T08:26:17.610Z",
      "createdAt": "2025-11-03T08:26:17.610Z",
      "id": "axqP97d5KH0Xmtnv",
      "name": "bookmagol"
    },
    {
      "updatedAt": "2025-11-03T08:26:17.571Z",
      "createdAt": "2025-11-03T08:26:17.571Z",
      "id": "nhXuS9gJhshUWFiF",
      "name": "etc"
    }
  ]
}